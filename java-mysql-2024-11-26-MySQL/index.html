<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><link rel="icon" type="image/ico" sizes="32x32" href="../assets/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="../assets/apple-touch-icon.png"><link rel="alternate" href="../rss.xml" title="Maple" type="application/rss+xml"><link rel="alternate" href="../atom.xml" title="Maple" type="application/atom+xml"><link rel="alternate" type="application/json" title="Maple" href="https://mapleplus.github.io/feed.json"><link rel="preconnect" href="https://s4.zstatic.net"><link rel="preconnect" href="https://at.alicdn.com"><link rel="preconnect" href="https://lf9-cdn-tos.bytecdntp.com"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://unpkg.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="../css/app.css?v=0.4.16"><link rel="modulepreload" href="../js/chunk-5QFCUDT2.js"><link rel="modulepreload" href="../js/chunk-AH3N6TMJ.js"><link rel="modulepreload" href="../js/chunk-ASTBZDCO.js"><link rel="modulepreload" href="../js/chunk-M3P2466O.js"><link rel="modulepreload" href="../js/chunk-QK7VVU5C.js"><link rel="modulepreload" href="../js/chunk-WIQECBEN.js"><link rel="modulepreload" href="../js/comments-6DCB2VQP.js"><link rel="modulepreload" href="../js/copy-tex-PXZUQ7LE.js"><link rel="modulepreload" href="../js/index.esm-5UGATQNX.js"><link rel="modulepreload" href="../js/post-IX7RYCZG.js"><link rel="modulepreload" href="../js/quicklink-QEWV64WY.js"><link rel="modulepreload" href="../js/search-ZHFXE5AH.js"><link rel="modulepreload" href="../js/siteInit.js"><link rel="modulepreload" href="../js/waline-NVSVNCZW.js"><link rel="stylesheet" href="../css/comments-LAB2J3GR.css" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="../css/siteInit.css" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="../css/waline-7JVHAYE3.css" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="preload" href="https://image.fxink.cn/maple/adf5915ce3d3dc45e5369e0433c2b4a2.png" as="image" fetchpriority="high"><link rel="preload" href="https://image.fxink.cn/maple/1366129.jpeg" as="image" fetchpriority="high"><link rel="preload" href="https://image.fxink.cn/maple/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E7%BE%8E%E5%A5%B3-%E9%BB%91%E4%B8%9D.png" as="image" fetchpriority="high"><link rel="preload" href="https://image.fxink.cn/maple/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E7%BE%8E-%E7%BE%8E%E5%A5%B3.png" as="image" fetchpriority="high"><link rel="preload" href="https://image.fxink.cn/maple/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E7%9C%9F%E4%BA%BA-%E7%BE%8E%E5%A5%B3.png" as="image" fetchpriority="high"><link rel="preload" href="https://image.fxink.cn/maple/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E4%BA%8C%E6%AC%A1%E5%85%83-%E5%8A%A8%E6%BC%AB.png" as="image" fetchpriority="high"><meta name="keywords" content="sql,MySQL"><meta name="description" content="为国民幸福而国家富强"><link rel="canonical" href="https://mapleplus.github.io/java-mysql-2024-11-26-MySQL/"><title>MySQL</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">MySQL</h1><div class="meta"><span class="item" title="创建时间：2024-11-26 12:51:59"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2024-11-26T12:51:59+08:00">2024-11-26</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>36k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>32 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Maple Plus</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><ul><li class="item" style="background-image: url(&quot;https://image.fxink.cn/maple/adf5915ce3d3dc45e5369e0433c2b4a2.png&quot;);"></li><li class="item" style="background-image: url(&quot;https://image.fxink.cn/maple/1366129.jpeg&quot;);"></li><li class="item" style="background-image: url(&quot;https://image.fxink.cn/maple/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E7%BE%8E%E5%A5%B3-%E9%BB%91%E4%B8%9D.png&quot;);"></li><li class="item" style="background-image: url(&quot;https://image.fxink.cn/maple/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E7%BE%8E-%E7%BE%8E%E5%A5%B3.png&quot;);"></li><li class="item" style="background-image: url(&quot;https://image.fxink.cn/maple/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E7%9C%9F%E4%BA%BA-%E7%BE%8E%E5%A5%B3.png&quot;);"></li><li class="item" style="background-image: url(&quot;https://image.fxink.cn/maple/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E4%BA%8C%E6%AC%A1%E5%85%83-%E5%8A%A8%E6%BC%AB.png&quot;);"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemlistelement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="../index.html">首页</a></span><i class="ic i-angle-right"></i><span itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="../categories/java/" itemprop="item" rel="index" title="分类于Java"><span itemprop="name">Java<meta itemprop="position" content="0"></span></a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="../categories/java/mysql/" itemprop="item" rel="index" title="分类于MySQL"><span itemprop="name">MySQL<meta itemprop="position" content="1"></span></a></span></div><article class="post block" itemscope="itemscope" itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://mapleplus.github.io/java-mysql-2024-11-26-MySQL/"><span hidden="hidden" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="image" content="../assets/avatar.png"><meta itemprop="name" content="Maple Plus"><meta itemprop="description" content="枫的秘密基地, 为国民幸福而国家富强"></span><span hidden="hidden" itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Maple"></span><div class="body md" itemprop="articleBody"><h2 id="基础储备"><a class="anchor" href="#基础储备">#</a> 基础储备</h2>
<p>DDL: 数据定义语言 创建管理库、表</p>
<p>DML: 数据操作语言 表增删改查</p>
<p>DCL: 数据控制语言</p>
<h2 id="dml-查询"><a class="anchor" href="#dml-查询">#</a> DML 查询</h2>
<h3 id="多表查询的基本介绍"><a class="anchor" href="#多表查询的基本介绍">#</a> 多表查询的基本介绍</h3>
<ol>
<li>需要有连接方式</li>
<li>需要指明字段所在表</li>
<li>可以在 FROM 给表起别名增加可读性，在 SELECT 和 WHERE 使用别名</li>
<li>n 个表实现多表查询需要 n-1 个连接条件</li>
</ol>
<h3 id="自连接-非自连接"><a class="anchor" href="#自连接-非自连接">#</a> 自连接 非自连接</h3>
<ul>
<li>自连接：自我引用
<ul>
<li>员工和管理者的对应关系：员工 id = 管理者 id</li>
</ul>
</li>
</ul>
<h3 id="内连接-外连接"><a class="anchor" href="#内连接-外连接">#</a> 内连接 外连接</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#多个表内连接</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">JOIN</span> B</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">ON</span> B<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> C<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul>
<li>内连接：合并具有同一列的两个以上的表的行，结果集中<strong>不包含</strong>一个表与另一个表<strong>不匹配的行</strong>
<ul>
<li>JOIN ON</li>
</ul>
</li>
<li>外连接：两个表在连接过程中除了返回满足连接条件的行以外<strong>还返回左 / 右表中不满足条件的行</strong>，这种称左 / 右外连接。没有匹配的行时，结果表中相应列为<strong> NULL</strong>（关键字：所有，多个表）</li>
<li>左外连接：左表为主表，右表为从表（关键字：所有，多个表）LEFT JOIN ON</li>
<li>右外连接：右表为主表，左表为从表（关键字：所有，多个表）RIGHT JOIN ON</li>
<li>UNION：返回两个查询结果的并集，去重</li>
<li>UNION ALL（效率更高）：返回两个查询结果的并集，不去重（推荐使用）</li>
</ul>
<p><img loading="lazy" data-src="image-20240504182343163.png" alt="image-20240504182343163"></p>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#左上图</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span>  B</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#右上图</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span>  B</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#左中图</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span>  B</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">WHERE</span> B<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#右中图</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span>  B</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">WHERE</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#中图 内连接</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">JOIN</span> B</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr></table></figure><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#左下图 左上 + 右中 满外连接</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span>  B</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">UNION</span> <span class="token keyword">ALL</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span>  B</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">WHERE</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#左下图 右上 + 左中 满外连接</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span>  B</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">UNION</span> <span class="token keyword">ALL</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span>  B</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">WHERE</span> B<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#右下图 左中 + 右中</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span>  B</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">WHERE</span> B<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">UNION</span> <span class="token keyword">ALL</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span>  B</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">data</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">WHERE</span> A<span class="token punctuation">.</span><span class="token keyword">data</span> <span class="token operator">=</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul>
<li>
<p>补充（可用可不用）：</p>
</li>
<li>
<p>NATURAL JOIN: 自动查询两张连接表中<strong>所有相同的字段</strong>，然后进行<strong>等值连接</strong></p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">JOIN</span> B</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span>data1 <span class="token operator">=</span> B<span class="token punctuation">.</span>data1</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">AND</span> A<span class="token punctuation">.</span>data2 <span class="token operator">=</span> B<span class="token punctuation">.</span>data2</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 等价</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">NATURAL</span> <span class="token keyword">JOIN</span> B<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li></li>
</ul>
</li>
<li>
<p>USING:<strong> 两个不同表</strong>中相同的字段（自连接不使用，字段不一样）</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">JOIN</span> B</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">ON</span> A<span class="token punctuation">.</span>data1 <span class="token operator">=</span> B<span class="token punctuation">.</span>data1</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#等价</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">SELECT</span> a1<span class="token punctuation">,</span>b1</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">FROM</span> A <span class="token keyword">JOIN</span> B<span class="token comment">#相同字段</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">USING</span> <span class="token punctuation">(</span>data1<span class="token punctuation">)</span></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="函数"><a class="anchor" href="#函数">#</a> 函数</h2>
<h3 id="单行函数"><a class="anchor" href="#单行函数">#</a> 单行函数</h3>
<h4 id="基础认识"><a class="anchor" href="#基础认识">#</a> 基础认识</h4>
<ul>
<li>操作数据对象</li>
<li>接受参数返回一个结果</li>
<li>只对一行进行变换</li>
<li>可以嵌套</li>
<li>参数可以是一列或一个值</li>
</ul>
<h4 id="数值型函数"><a class="anchor" href="#数值型函数">#</a> 数值型函数</h4>
<h5 id="基本函数"><a class="anchor" href="#基本函数">#</a> 基本函数</h5>
<ul>
<li><code>ABS(x)</code> ：返回 x 的绝对值</li>
<li><code>SIGN(x)</code> ：返回 x 的符号，正数 1，负数 - 1,0 返回 0</li>
<li><code>PI()</code> ：返回圆周率</li>
<li><code>CEIL(x),CEILING(x)</code> ：返回 <code>&gt;=x</code>  的最小整数</li>
<li><code>FLOOR(x)</code> ：返回 <code>&lt;=x</code>  的最大整数</li>
<li><code>LEAST(x1,x2,x3…)</code> ：返回列表最小值</li>
<li><code>GREATEST(x1,x2,x3…)</code> ：返回列表最大值</li>
<li><code>MOD(x,y)</code> ：返回 x 除以 y 后的余数</li>
<li><code>RAND()</code> ：返回 0~1 的随机值</li>
<li><code>RAND(x)</code> ：返回 0~1 的随机值，相同的 x 值会产生相同的随机数</li>
<li><code>ROUND(x)</code> ：返回对 x 四舍五入的值</li>
<li><code>ROUND(x,y)</code> ：返回对 x 四舍五入的值，保留小数点后 y 位</li>
<li><code>TRUNCATE(x,y)</code> ：返回截断 y 位小数后的结果</li>
<li><code>SQRT(x)</code> ：返回 x 的平方根，x &lt; 0 返回 NULL</li>
<li><code>POW(x,y)</code> : 返回 x 的 y 次方</li>
<li><code>EXP(x)</code> :e 的 x 次方</li>
<li><code>LN(x)/LOG(x)</code> ：返回<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">log</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span><sub>e</sub> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>​</li>
<li><code>LOG10(x) LOG2(x)</code> : 返回<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">log</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span><sub>10</sub> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">log</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span><sub>2</sub> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>​</li>
<li><code>BIN(x) OCT(x) HEX(x)</code> :x 的进制数</li>
</ul>
<h4 id="字符串函数"><a class="anchor" href="#字符串函数">#</a> 字符串函数</h4>
<ul>
<li><code>ASCLL(S)</code> : 返回字符串第一个字符的 ASCLL 码</li>
<li><code>CHAR_LENGTH(S)</code> ：返回字符个数</li>
<li><code>LENGTH(S)</code> : 返回字节数（中文一个字符占 3 个字节）</li>
<li><code>CONCAT(S1,S2,S3…)</code> : 连接多个字符串</li>
<li><code>CONCAT(x,S1,S2,S3…)</code> : 用<em> x</em> 连接多个字符串</li>
<li><code>INSERT(str,pos,length,newstr)</code> : 将 str 中 pos 位置往后 length 个字符替换成 newstr, 如果 pos 不在字符串的长度范围内，则返回原始字符串。如果 len 不在字符串其余部分的长度范围内，则从位置 pos 替换字符串的其余部分。如果任何参数为 NULL，则返回 NULL</li>
<li><code>REPLACE(str,from_str,to_str)</code> : 其中所有出现的字符串 from_str 都替换为字符串 to_str</li>
<li><code>UPPER(S) LOWER(S)</code> : 大小写转换</li>
<li><code>LEFT(S,n) RIGHT(S,n)</code> : 从左 / 右取 n 个字符</li>
<li><code>LPAD(str,len,padstr) RPAD(str,len,padstr)</code> : 左 / 右对齐，用字符串 padstr 左 / 右填充到一定长度的 len 字符。如果 str 长于 len，则返回值将缩短为 len 字符。如果 str、padstr 或 len 是 NULL，则函数返回 NULL</li>
<li><code>LTRIM(S) RTRIM(S) TRIM(S)</code> : 去掉 S 左 / 右 / 开始和结尾 的空格</li>
<li><code>TRIM(LEADING s1 from s) TRIM(TRAILING s1 from s)TRIM(s1 from s)</code> : 去掉 s 开始 / 结尾 / 开始和结尾 的 s1</li>
<li><code>REPEAT(str，n)</code> : 返回重复 str 的 n 次重复结果</li>
<li><code>SPACE(n)</code> : 返回 n 个空格</li>
<li><code>STRCMP(s1,s2)</code> : 比较两字符串 ASCLL 大小</li>
<li><code>SUBSTR(str,index,len)</code> : 返回 str 从 index 开始往后 len 个字符</li>
<li><code>LOCATE(s1,s2)</code> : 返回 s1 在 s2 中首次出现的位置</li>
<li><code>ELT(n,s1,s2…)</code> :n=1, 返回 s1,n=2, 返回 s2</li>
<li><code>FIELD(str，s1,s2…)</code> : 返回 str 在字符串列表第一次出现的位置</li>
<li><code>FIND_INSET(s1,s2)</code> : 返回 s1 在 s2 中出现的位置</li>
<li><code>REVERSE(s)</code> : 返回反转后的字符串</li>
<li><code>NULLIF(value1,value2)</code> :value1=value2 返回 NULL, 否则返回 value1</li>
</ul>
<h4 id="日期和时间函数"><a class="anchor" href="#日期和时间函数">#</a> 日期和时间函数</h4>
<ul>
<li><code>CURDATA()</code> ：返回当前日期</li>
<li><code>CURTIME()</code> ：返回当前时间</li>
<li><code>NOW()</code> ：返回当前日期和时间</li>
<li><code>UNIX_TIMESTAMP()</code> ：返回当前时间的时间戳</li>
<li><code>UNIX_TIMESTAMP(data)</code> ：返回指定时间 data 的时间戳</li>
<li><code>FROM_UNIXTIME(timestamp)</code> ：将时间戳转换为普通格式的时间</li>
<li><code>YEAR(date) / MONTH(date) / DAY(date)</code> ：返回具体的日期值</li>
<li><code>HOUR(time) / MINUTE(time) / SECOND(time)</code> ：返回具体的时间值</li>
<li><code>MONTHNAME(date)</code> ：返回月份：January...</li>
<li><code>DAYNAME(date)</code> ：返回星期几：MONDAY，TUESDAY....SUNDAY</li>
<li><code>WEEKDAY(date)</code> ：返回周几，注意，周 1 是 0，周 2 是 1… 周日是 6</li>
<li><code>QUARTER(date)</code> ：返回日期对应的季度，范围为 1-4</li>
<li><code>WEEK(date)，WEEKOFYEAR(date)</code> ：返回一年中的第几周</li>
<li><code>DAYOFMONTH(date)</code> ：返回日期位于所在月份的第几天</li>
<li><code>DAYOFWEEK(date)</code> ：返回周几，注意：周日是 1，周一是 2… 周六是 7</li>
<li><code>EXTRACT(type FROM data)</code> ：返回指定日期的特定部分，type 指定返回值</li>
<li><code>TIME_TO_SEC(time)</code> : 将 time 转换为秒返回结果</li>
<li><code>SEC_TO_TIME(seconds)</code> ：将 seconds 转换为时分秒</li>
<li><code>ADDTIME(time1，time2)</code> ：返回 time1 加上 time2 的时间。当 time2 为一个数字时，代表的是秒，可以为负数</li>
<li><code>SUBTIME(time1, time2)</code> ：返回 time1 减去 time2 后的时间。当 time2 为一个数字时，代表的是秒，可以为负数</li>
<li><code>ADDDATE(date1，date2)</code> ：返回 date1 加上 date2 的时间。当 date2 为一个数字时，代表的是日，可以为负数</li>
<li><code>SUBDATE(date1, date2)</code> ：返回 date1 减去 date2 后的时间。当 date2 为一个数字时，代表的是日，可以为负数</li>
<li><code>DATEDIFF(date1, date2)</code> ：返回 date1 - date2 的日期间隔天数</li>
<li><code>TIMEDIFF(time1, time2)</code> ：返回 time1 - time2 的时间间隔</li>
<li><code>FROM_DAYS(N)</code> ：返回从 0000 年 1 月 1 日起，N 天以后的日期</li>
<li><code>TO_DAYS(date)</code> ：返回日期 date 距离 0000 年 1 月 1 日的天数</li>
<li><code>LAST_DAY(date)</code> ：返回 date 所在月份的最后一天的日期</li>
<li><code>MAKEDATE(year, n)</code> ：对给定年份与所在年份中的天数返回一个日期</li>
<li><code>MAKETIME(hour, minute, second)</code> ：将给定的小时、分钟和秒组合成时间并返回</li>
<li><code>PERIOD_ADD(time, n)</code> ：返回 time 加上 n 后的时间</li>
<li><code>DATE_FORMAT(date,fmt)</code> ：按照字符串 fmt 格式化日期 date 值</li>
<li><code>TIME_FORMAT(time,fmt)</code> ：按照字符串 fmt 格式化时间 time 值</li>
<li><code>GET_FORMAT(date_type,format_type)</code> ：返回日期字符串的显示格式</li>
<li><code>STR_TO_DATE(str, fmt)</code> ：按照字符串 fmt 对 str 进行解析，解析为一个日期</li>
</ul>
<h4 id="流程控制函数"><a class="anchor" href="#流程控制函数">#</a> 流程控制函数</h4>
<ul>
<li><code>IF(value,value1,value2)</code> ：如果 value 的值为 TRUE，返回 value1，否则返回 value2</li>
<li><code>IFNULL(value1, value2)</code> ：如果 value1 不为 NULL，返回 value1，否则返回 value2</li>
<li><code>CASE WHEN 条件1 THEN 结果1 WHEN 条件2 THEN 结果2 ELSE 值n END</code> ：相当于 Java 的 if...else if...else...</li>
<li><code>CASE expr WHEN 常量值1 THEN 值1 WHEN 常量值2 THEN 值2 ELSE 值n  END</code> ：相当于 Java 的 switch...case...</li>
</ul>
<h3 id="聚合函数分组函数"><a class="anchor" href="#聚合函数分组函数">#</a> 聚合函数（分组函数）</h3>
<ul>
<li>作用于一组数据，并返回一个值</li>
</ul>
<h4 id="1常见的聚合函数"><a class="anchor" href="#1常见的聚合函数">#</a> 1. 常见的聚合函数</h4>
<h5 id="avg-sum数值"><a class="anchor" href="#avg-sum数值">#</a> AVG / SUM（数值）</h5>
<ul>
<li>
<p>会自动过滤 NULL 值</p>
</li>
<li>
<p>AVG: 求平均值</p>
</li>
<li>
<p>SUM：总和</p>
</li>
</ul>
<h5 id="max-min数值字符串类日期-时间类"><a class="anchor" href="#max-min数值字符串类日期-时间类">#</a> MAX / MIN（数值 / 字符串类 / 日期、时间类）</h5>
<ul>
<li>
<p>MAX：最大值</p>
</li>
<li>
<p>MIN：最小值</p>
</li>
</ul>
<h5 id="count"><a class="anchor" href="#count">#</a> COUNT</h5>
<ul>
<li>作用：计算 <code>指定字段</code> 在查询结果中出现的个数，不计算 NULL 值</li>
<li>查询表中所有记录
<ul>
<li>COUNT(*)</li>
<li>COUNT(all integer)</li>
<li>COUNT (field): 不一定完整，因为不计算 NULL 值</li>
</ul>
</li>
<li>AVG = SUM / COUNT</li>
</ul>
<h4 id="2group-by-f1f2"><a class="anchor" href="#2group-by-f1f2">#</a> 2.GROUP BY f1,f2…</h4>
<blockquote>
<p>引入：查询各个部门的平均工资 / 最高工资等，需要将所有员工按照部门分到相应的组</p>
</blockquote>
<ul>
<li>
<p>一组一条字段</p>
</li>
<li>
<p>SELECT 中出现的非组函数的字段必须声明在 GROUP BY 中</p>
</li>
<li>
<p>GROUP BY 中声明的字段可以不出现在 SELECT 中</p>
</li>
<li>
<p>GROUP BY 声明位置：</p>
<ul>
<li>FROM</li>
<li>WHERE</li>
<li>GROUP BY</li>
<li>ORDER BY</li>
<li>LIMIT</li>
</ul>
</li>
<li>
<p>WITH ROLLUP：在所有查询出的分组记录之后增加一条所有记录的总和，即统计记录数量</p>
<ul>
<li>
<blockquote>
<p>使用 ROLLUP 时，不能同时使用 ORDER BY 排序，两者互斥</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h4 id="3having"><a class="anchor" href="#3having">#</a> 3.HAVING</h4>
<ul>
<li>HAVING 用于过滤数据</li>
<li>HAVING 与 GROUP BY 一起使用，且在 GROUP BY 后面</li>
<li>当过滤条件使用聚合函数，必须使用 HAVING 替换 WHERE</li>
<li>当过滤条件没有聚合函数，使用 WHERE (效率更高)</li>
<li>HAVING 使用范围更广</li>
</ul>
<h4 id="sql底层原理"><a class="anchor" href="#sql底层原理">#</a> SQL 底层原理</h4>
<ul>
<li>
<p>SELECT 完整结构</p>
<ul>
<li></li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">FROM</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">LEFT</span> <span class="token operator">/</span> <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">ON</span> 多表连接条件</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">LEFT</span> <span class="token operator">/</span> <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">ON</span> 多表连接条件</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">WHERE</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>不包含聚合函数的过滤条件<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">HAVING</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>不包含聚合函数的过滤条件<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">ASC</span> <span class="token operator">/</span> <span class="token keyword">DESC</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">LIMIT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr></table></figure></li>
<li>
<p>执行顺序</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">FROM</span> <span class="token comment">---> ON ---> LEFT / RIGHT JOIN ---> WHERE ---></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token comment">---> HAVING ---> SELECT ---> ORDER BY ---></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">LIMIT</span></pre></td></tr></table></figure></li>
<li>
<blockquote>
<p>由此知道当过滤条件没有聚合函数，使用 WHERE 效率更高的原因，HAVING 要等 GROUP BY 对数据进行分组后再执行过滤，而 WHERE 省略了这一步骤</p>
</blockquote>
</li>
<li>
<blockquote>
<p>SELECT 声明的别名只能在后面使用，而不能在之前使用，如 WHERE</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="子查询"><a class="anchor" href="#子查询">#</a> 子查询</h3>
<h4 id="基本介绍"><a class="anchor" href="#基本介绍">#</a> 基本介绍</h4>
<ul>
<li>
<p>查询语句的嵌套</p>
</li>
<li>
<p>提升查询的效率</p>
</li>
<li>
<p>分类一：  <code>外查询（主查询） 内查询（子查询）</code></p>
<ul>
<li>
<p>子查询（内查询）在主查询之前一次执行完成</p>
</li>
<li>
<p>子查询的结果被主查询使用</p>
</li>
<li>
<blockquote>
<p>子查询要包含在括号内</p>
<p>将子查询放在比较条件的右侧</p>
<p>单行操作符对应单行子查询，多行操作符对应多行子查询</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>分类二： <code>相关子查询 不相关子查询</code></p>
<ul>
<li>不相关子查询：子查询从数据表查到了结果，结果只执行一次，然后该结果用于主查询的条件执行</li>
<li>相关子查询：子查询需要执行多次，先从外部查询开始，每次都传入子查询进行查询，然后再返回结果给外部</li>
</ul>
</li>
<li>
<p>处理 GROUP BY 和 LIMIT ，其他地方均可以使用子查询</p>
</li>
</ul>
<h4 id="单行子查询"><a class="anchor" href="#单行子查询">#</a> 单行子查询</h4>
<ul>
<li>单行操作符：= != &gt; &gt;= &lt;= &lt;</li>
<li>编写技巧：
<ul>
<li>从里往外写</li>
<li>从外往里写（需求比较长时）</li>
</ul>
</li>
<li>空值情况：如果子查询的结果为 NULL, 则子查询不返回任何行，主查询不显示任何数据</li>
<li>非法子查询：如 = 右边返回的是多条数据（如分组）</li>
</ul>
<h4 id="多行子查询"><a class="anchor" href="#多行子查询">#</a> 多行子查询</h4>
<ul>
<li>内查询返回多行</li>
<li>使用多行比较运算符</li>
<li>IN：等于列表中的任意一个</li>
<li>ANY：和单行操作符一起使用，等于任一个（满足有一个就行）</li>
<li>ALL：和单行操作符一起使用，与返回的所有值进行比较（满足所有）</li>
<li>空值情况：如果子查询的结果为 NULL, 则子查询不返回任何行，主查询不显示任何数据</li>
</ul>
<h4 id="more"><a class="anchor" href="#more">#</a> more</h4>
<ul>
<li>除了 GROUP BY 和 LIMIT , 其他地方都可以使用子查询</li>
<li>处理 AVG 和 MAX/MIN 时，将 AVG 重写成一个表，将 AVG 定义一个字段，放于 FROM 中，MAX (字段)/MIN (字段) 即可</li>
</ul>
<h2 id="ddl-创建-修改-删除-库-表"><a class="anchor" href="#ddl-创建-修改-删除-库-表">#</a> DDL 创建 修改 删除 库、表</h2>
<h3 id="创建数据库"><a class="anchor" href="#创建数据库">#</a> 创建数据库</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 创建</span></pre></td></tr><tr><td data-num="2"></td><td><pre> <span class="token keyword">CREATE</span> DATEBASE <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> mydata <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> ‘utf8’<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre> </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 查看所有数据库 </span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">DATABASES</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 查看建库语句 </span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> DATEBASE mydata<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment"># 切换数据库</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">USE</span> mydata2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment"># 查看当前数据库的表</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># 查看指定数据库的表</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span> <span class="token keyword">FROM</span> mydata<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment"># 查看当前使用的数据库</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">DATABASE</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="修改数据库"><a class="anchor" href="#修改数据库">#</a> 修改数据库</h3>
<ul>
<li>修改指定字符集 ALTER DATEBASE mydata CHARACTER SET ‘utf8’;</li>
<li>数据库名不能更改</li>
</ul>
<h3 id="删除数据库"><a class="anchor" href="#删除数据库">#</a> 删除数据库</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token keyword">DATABASE</span> mydata<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="创建表"><a class="anchor" href="#创建表">#</a> 创建表</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 方式一</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> mytable<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	id <span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    salary <span class="token keyword">DECIMAL</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">date</span> <span class="token keyword">DATE</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 查看表结构</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">DESC</span> mytable<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># 查看建表语句</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> mytable<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment"># 方式二</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># 基于现有的表创建表，并导入数据</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment"># SELECT 可有多种语句，如左连接，子查询等，将查询的语句做新表</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> mytable2</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">AS</span> </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span><span class="token keyword">date</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">from</span> mytable<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment"># WHERE 1 = 2; 只创建字段，不导入数据</span></pre></td></tr></table></figure><h3 id="修改表"><a class="anchor" href="#修改表">#</a> 修改表</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 添加一个字段</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 默认添加到最后一列</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> mytable01</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ADD</span> salary <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 添加到指定位置</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> mytable01</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">ADD</span> age <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">AFTER</span> name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 修改字段（一般不会修改，可能修改大小）</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> mytable01</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">MODIFY</span> name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># 重命名字段</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> mytable01</pre></td></tr><tr><td data-num="13"></td><td><pre>CHANGE name my_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># 删除字段</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> mytable01</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">DROP</span> my_date<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="重命名表"><a class="anchor" href="#重命名表">#</a> 重命名表</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 重命名表</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">RENAME</span> <span class="token keyword">TABLE</span> mytable01</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">TO</span> mytable<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="删除表"><a class="anchor" href="#删除表">#</a> 删除表</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 删除表 表结构和数据</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> tasks<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="清空表"><a class="anchor" href="#清空表">#</a> 清空表</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 清空表 数据</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> mytable01<span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote>
<h2 id="dcl"><a class="anchor" href="#dcl">#</a> DCL</h2>
<h3 id="commit"><a class="anchor" href="#commit">#</a> COMMIT；</h3>
<ul>
<li>提交数据，一旦执行，数据永久保存到数据库中，不可以回滚</li>
</ul>
<h3 id="rollback"><a class="anchor" href="#rollback">#</a> ROLLBACK；</h3>
<ul>
<li>回滚数据，一旦执行，实现数据的回滚，回滚到<strong>最近的一次</strong> COMMIT 之后</li>
</ul>
</blockquote>
<h3 id="回滚"><a class="anchor" href="#回滚">#</a> 回滚</h3>
<ul>
<li>TRUNCATE TABLE：清除全部表数据，不可以回滚，代表<strong> DDL</strong></li>
<li>DELETE FROM：不带 WHERE 字句时，表数据可以全部清除，数据可以回滚，代表<strong> DML</strong></li>
<li>DDL：操作一旦执行，不可回滚，指令 <code>SET autocommit = FALSE;</code>  失效</li>
<li>DML：默认执行后也不可回滚，如果执行 DML 之前 <code>SET autocommit = FALSE;</code>  则可以实现回滚</li>
</ul>
<h2 id="dml-增删改-数据"><a class="anchor" href="#dml-增删改-数据">#</a> DML 增删改 数据</h2>
<ul>
<li>默认执行后不可回滚，如果执行 DML 之前 <code>SET autocommit = FALSE;</code>  则可以实现回滚</li>
</ul>
<h3 id="添加数据"><a class="anchor" href="#添加数据">#</a> 添加数据</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 添加多条记录 按照表后括号顺序添加，字段数量可少，但少的字段需要可以设置 NULL</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> mytable01<span class="token punctuation">(</span>my_name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>id<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Curry'</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">20000</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>       <span class="token punctuation">(</span><span class="token string">'James'</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 将查询的结果添加到表中 字段顺序要对应，mytable02 的字段长度不能低于 mytable01 的字段长度</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> mytable02<span class="token punctuation">(</span>id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>my_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">FROM</span> mytable01<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="删除数据"><a class="anchor" href="#删除数据">#</a> 删除数据</h3>
<ul>
<li>DELETE…WHERE…</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> mytable02</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="更新数据"><a class="anchor" href="#更新数据">#</a> 更新数据</h3>
<ul>
<li>UPDATE…SET…WHERE…</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">UPDATE</span> mytable02</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">,</span>name <span class="token operator">=</span> <span class="token string">'Jordan'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="sql80-新特性"><a class="anchor" href="#sql80-新特性">#</a> sql8.0 新特性</h3>
<ul>
<li>计算列</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> cauculate<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    num1 <span class="token keyword">int</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    num2 <span class="token keyword">int</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    sum <span class="token keyword">int</span> GENERATED ALWAYS <span class="token keyword">AS</span></pre></td></tr><tr><td data-num="5"></td><td><pre>                      <span class="token punctuation">(</span>num1 <span class="token operator">+</span> num2<span class="token punctuation">)</span> VIRTUAL</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="数据类型"><a class="anchor" href="#数据类型">#</a> 数据类型</h2>
<h3 id="整型"><a class="anchor" href="#整型">#</a> 整型</h3>
<h2 id="约束"><a class="anchor" href="#约束">#</a> 约束</h2>
<h3 id="概述"><a class="anchor" href="#概述">#</a> 概述</h3>
<ul>
<li>数据完整性是指数据的<strong>精确性</strong>和<strong>可靠性</strong></li>
<li><strong>实体完整性</strong> ：例如，同一个表中，不能存在两条完全相同无法区分的记录</li>
<li><strong>域完整性</strong> ：例如：年龄范围 0-120，性别范围 “男 / 女”</li>
<li><strong>引用完整性</strong> ：例如：员工所在部门，在部门表中要能找到这个部门</li>
<li><strong>用户自定义完整性</strong> ：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的 5 倍</li>
</ul>
<h3 id="约束分类"><a class="anchor" href="#约束分类">#</a> 约束分类</h3>
<ul>
<li>
<p>根据约束数据列的限制</p>
<ul>
<li>
<p>单列约束：每个约束只约束一列</p>
</li>
<li>
<p>多列约束：每个约束可约束多列数据</p>
</li>
</ul>
</li>
<li>
<p>根据约束的作用范围</p>
<ul>
<li>列级约束：只能作用在一个列上，跟在列的定义后面</li>
<li>表级约束：可以作用在多个列上，不与列一起，而是单独定义</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">位置</th>
<th style="text-align:center">支持的约束类型</th>
<th style="text-align:center">是否可以起约束名</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">列级约束</td>
<td style="text-align:center">列的后面</td>
<td style="text-align:center">语法都支持，但外键没有效果</td>
<td style="text-align:center">不可以</td>
</tr>
<tr>
<td style="text-align:center">表级约束</td>
<td style="text-align:center">所有列的下面</td>
<td style="text-align:center"><code>默认和非空</code> 不支持，其他支持</td>
<td style="text-align:center">可以（主键没有效果）</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>根据约束起的作用，约束可分为：</p>
<ul>
<li>NOT NULL 非空约束，规定某个字段不能为空</li>
<li>UNIQUE 唯一约束，规定某个字段在整个表中是唯一的</li>
<li>PRIMARY KEY 主键 (非空且唯一) 约束</li>
<li>FOREIGN KEY 外键约束</li>
<li>CHECK 检查约束</li>
<li>DEFAULT 默认值约束</li>
</ul>
<blockquote>
<p>注意： sql 不支持 check 约束，但可以使用 check 约束，而没有任何效果</p>
</blockquote>
</li>
<li>
<p>查看某个表已有的约束</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#information_schema 数据库名（系统库）</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">#table_constraints 表名称（专门存储各个表的约束）</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>table_constraints </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">WHERE</span> table_name <span class="token operator">=</span> <span class="token string">'表名称'</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h3 id="非空约束"><a class="anchor" href="#非空约束">#</a> 非空约束</h3>
<ul>
<li>
<p>NOT NULL</p>
</li>
<li>
<p><code>不支持表级约束</code></p>
</li>
<li>
<p>默认所有的类型的值都可以是 NULL，包括 INT、FLOAT 等数据类型</p>
</li>
<li>
<p>非空约束只能出现在表对象的列上，只能某个列单独限定非空，不能组合非空</p>
</li>
<li>
<p>一个表可以有很多列都分别限定了非空</p>
</li>
<li>
<p>空字符串 '' 不等于 NULL，0 也不等于 NULL</p>
</li>
<li>
<p>添加非空约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#建表时</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    字段名  数据类型 <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    字段名  数据类型 <span class="token operator">NOT</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#建表后</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>删除非空约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#去掉 not null，相当于修改某个非注解字段，该字段允许为空 </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#或</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="唯一性约束"><a class="anchor" href="#唯一性约束">#</a> 唯一性约束</h3>
<ul>
<li>
<p>UNIQUE KEY</p>
</li>
<li>
<p>同一个表可以有多个唯一约束</p>
</li>
<li>
<p>唯一约束可以是某一个列的值唯一，也可以多个列组合的值唯一</p>
</li>
<li>
<p><code>唯一性约束允许列值为NULL</code></p>
</li>
<li>
<p>在创建唯一约束的时候，如果不给唯一约束命名，就默认和列名相同</p>
</li>
<li>
<p>添加唯一约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#建表时</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    字段名  数据类型  <span class="token keyword">unique</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    字段名  数据类型  <span class="token keyword">unique</span> <span class="token keyword">key</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">constraint</span> 约束名 <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#表示用户名和密码组合不能重复</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">USER</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre> id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre> name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre> password <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre> <span class="token comment">-- 使用表级约束语法</span></pre></td></tr><tr><td data-num="7"></td><td><pre> <span class="token keyword">CONSTRAINT</span> uk_name_pwd <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>password<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#建表后指定唯一键约束</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">#字段列表中如果是一个字段，表示该列的值唯一</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#如果是两个或更多个字段，那么复合唯一，即多个字段的组合是唯一的</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">add</span> <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>复合唯一约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#字段列表中写的是多个字段名，多个字段名用逗号分隔，表示那么是复合唯一，即多个字段的组合是唯一的</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>删除唯一约束</p>
<ul>
<li>
<p>添加唯一性约束的列上也会自动创建唯一索引</p>
</li>
<li>
<p>删除唯一约束 <code>只能通过</code> 删除唯一索引的方式删除</p>
</li>
<li>
<p>删除时需要指定唯一索引名，唯一索引名就和唯一约束名一样</p>
</li>
<li>
<p>如果创建唯一约束时未指定名称，如果是单列，就默认和列名相同；如果是组合列，那么默认和 () 中排在 <code>第一个的列名</code> 相同。也可以自定义唯一性约束名</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">USER</span> </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> uk_name_pwd<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<blockquote>
<p>可以通过  <code>show index from 表名称;</code>  查看表的索引</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="primary-key-约束"><a class="anchor" href="#primary-key-约束">#</a> PRIMARY KEY 约束</h3>
<ul>
<li>
<p>PRIMARY KEY</p>
</li>
<li>
<p>用来唯一标识表中的一行记录</p>
</li>
<li>
<p>主键约束相当于<strong>唯一约束 + 非空约束</strong>的组合，主键约束列不允许重复，也不允许出现空值</p>
</li>
<li>
<p>一个表最多 <code>只能有一个</code> 主键约束，建立主键约束可以在列级别创建，也可以在表级别上创建。</p>
</li>
<li>
<p>主键约束对应着表中的一列或者多列（复合主键）</p>
</li>
<li>
<p>如果是多列组合的复合主键约束，那么这些列都 <code>不允许为空值</code> ，并且 <code>组合的值不允许重复</code> 。</p>
</li>
<li>
<p><code>sql的主键名总是PRIMARY</code> ，就算自己命名了主键约束名也没用。</p>
</li>
<li>
<p>当创建主键约束时，系统默认会在所在的列或列组合上建立对应的主键索引（能够根据主键查询的，就根据主键查询，效率更高）。如果删除主键约束了，主键约束对应的索引就自动删除了。</p>
</li>
<li>
<p>不要修改主键字段的值。因为主键是数据记录的唯一标识，如果修改了主键的值，就有可能会破坏数据的完整性</p>
</li>
<li>
<p>添加主键约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#建表时添加</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    字段名  数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span> <span class="token comment">#列级模式</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    字段名  数据类型  </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">constraint</span> 约束名 <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段名<span class="token punctuation">)</span> <span class="token comment">#表级模式</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 建表后添加</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">ADD</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#字段列表可以是一个字段，也可以是多个字段，如果是多个字段的话，是复合主键</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 复合主键</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    字段名  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段名<span class="token number">1</span><span class="token punctuation">,</span>字段名<span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment">#表示字段 1 和字段 2 的组合是唯一的，也可以有更多个字段</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>删除主键约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">drop</span> <span class="token keyword">primary</span> <span class="token keyword">key</span></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="自增列-auto_increment"><a class="anchor" href="#自增列-auto_increment">#</a> 自增列 AUTO_INCREMENT</h3>
<ul>
<li>
<p>AUTO_INCREMENT</p>
</li>
<li>
<p>某个字段的值自增</p>
</li>
<li>
<p>一个表最多 <code>只能有一个自增长列</code></p>
</li>
<li>
<p>当需要产生唯一标识符或顺序值时，可设置自增长</p>
</li>
<li>
<p>自增长列约束的列 <code>必须是键列（主键列，唯一键列）</code></p>
</li>
<li>
<p>自增约束的列的数据类型必须是整数类型</p>
</li>
<li>
<p>如果自增列指定了 0 和 null，会在当前最大值的基础上自增；如果自增列手动指定了具体值，直接赋值为具体值，且之后按此具体值自增</p>
</li>
<li>
<p>添加自增约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 建表时</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    字段名  数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    字段名  数据类型  <span class="token keyword">unique</span> <span class="token keyword">key</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    字段名  数据类型  <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    字段名  数据类型  <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> 默认值<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    字段名  数据类型 <span class="token keyword">default</span> 默认值 <span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    字段名  数据类型 <span class="token keyword">unique</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre>    字段名  数据类型 <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> 默认值<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段名<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 建表后</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token keyword">auto_increment</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>删除自增约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>sql 8.0 新特性 — 自增变量的持久化:sql 8.0 将自增主键的计数器持久化到 <code>重做日志</code> 中。每次计数器发生改变，都会将其写入重做日志中。如果数据库重启，InnoDB 会根据重做日志中的信息来初始化计数器的内存值</p>
</li>
</ul>
<h3 id="foreign-key-约束了解"><a class="anchor" href="#foreign-key-约束了解">#</a> *FOREIGN KEY 约束（了解）</h3>
<ul>
<li>
<p>从表的外键列，必须引用 / 参考主表的 <code>主键或唯一约束</code> 的列</p>
</li>
<li>
<p>在创建外键约束时，如果不给外键约束命名，默认名不是列名，而是自动产生一个外键名（例如 student_ibfk_1;），也可以指定外键约束名。(建议起别名)</p>
</li>
<li>
<p>创建 (CREATE) 表时就指定外键约束的话，先创建主表，再创建从表</p>
</li>
<li>
<p>删表时，先删从表（或先删除外键约束），再删除主表</p>
</li>
<li>
<p>在 **“从表”** 中指定外键约束，并且一个表可以建立多个外键约束</p>
</li>
<li>
<p>从表的外键列与主表被参照的列名字可以不相同，但是数据类型必须一样，逻辑意义一致。</p>
</li>
<li>
<p>当创建外键约束时，系统默认会在所在的列上建立对应的普通索引。但是索引名是外键的约束<br>
名。（根据外键查询效率很高）</p>
</li>
<li>
<p>删除外键约束后，必须手动删除对应的索引</p>
</li>
<li>
<p>添加外键约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 建表时</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 主表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    字段<span class="token number">1</span>  数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    字段<span class="token number">2</span>  数据类型</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 从表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    字段<span class="token number">1</span>  数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    字段<span class="token number">2</span>  数据类型<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">CONSTRAINT</span> 外键约束名称 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span>（从表的某个字段<span class="token punctuation">)</span> <span class="token keyword">references</span> 主表名<span class="token punctuation">(</span>被参考字段<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 建表后</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">CONSTRAINT</span> 外键约束名称 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span>（从表的某个字段<span class="token punctuation">)</span> <span class="token keyword">references</span> 主表名<span class="token punctuation">(</span>被参考字段<span class="token punctuation">)</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>Cascade 方式 ：在父表上 update/delete 记录时，同步 update/delete 掉子表的匹配记录</p>
</li>
<li>
<p>对于外键约束，最好是采用:   <code>ON UPDATE CASCADE ON DELETE RESTRICT</code>   的方式</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> emp<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    eid <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>  <span class="token comment">#员工编号</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    ename <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>     <span class="token comment">#员工姓名</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    deptid <span class="token keyword">int</span><span class="token punctuation">,</span>             <span class="token comment">#员工所在的部门</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>deptid<span class="token punctuation">)</span> <span class="token keyword">references</span> dept<span class="token punctuation">(</span>did<span class="token punctuation">)</span>  <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">set</span> <span class="token boolean">null</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">#把修改操作设置为级联修改等级，把删除操作设置为 set null 等级</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>删除外键约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 第一步先查看约束名和删除外键约束</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>table_constraints <span class="token keyword">WHERE</span> table_name <span class="token operator">=</span> <span class="token string">'表名称'</span><span class="token punctuation">;</span><span class="token comment">#查看某个</span></pre></td></tr><tr><td data-num="3"></td><td><pre>表的约束名</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 从表名 <span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> 外键约束名<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 第二步查看索引名和删除索引。（注意，只能手动删除）</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> 表名称<span class="token punctuation">;</span> <span class="token comment">#查看某个表的索引名</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 从表名 <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> 索引名<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>不得使用外键与级联，一切外键概念必须在应用层（用 java 进行外键约束的使用）解决</p>
</li>
</ul>
<h3 id="check-约束"><a class="anchor" href="#check-约束">#</a> CHECK 约束</h3>
<ul>
<li>
<p>CHECK</p>
</li>
<li>
<p>检查某个字段的值是否符号 xx 要求，一般指的是值的范围</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">temp</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>id <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>age <span class="token keyword">INT</span> <span class="token keyword">CHECK</span><span class="token punctuation">(</span>age <span class="token operator">></span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure></li>
</ul>
<h3 id="default约束"><a class="anchor" href="#default约束">#</a> DEFAULT 约束</h3>
<ul>
<li>
<p>DEFAULT</p>
</li>
<li>
<p>给某个字段 / 某列指定默认值，一旦设置默认值，在插入数据时，如果此字段没有显式赋值，则赋值为默认值。</p>
</li>
<li>
<p>默认值约束一般<strong>不在唯一键和主键列</strong>上加</p>
</li>
<li>
<p>添加默认值约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 建表时</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    字段名  数据类型  <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    字段名  数据类型  <span class="token keyword">unique</span> <span class="token keyword">key</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    字段名  数据类型  <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    字段名  数据类型  <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> 默认值</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 建表后</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token keyword">default</span> 默认值<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>删除默认值约束</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#删除默认值约束，也不保留非空约束</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#删除默认值约束，保留非空约束</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型  <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="视图"><a class="anchor" href="#视图">#</a> 视图</h2>
<h3 id="视图概述"><a class="anchor" href="#视图概述">#</a> 视图概述</h3>
<ul>
<li>视图是一种 虚拟表 ，本身是<strong>不具有数据</strong>的，占用很少的内存空间</li>
<li>视图建立在已有表的基础上，视图赖以建立的这些表称为<strong>基表</strong></li>
<li>视图的创建和删除只影响视图本身，不影响对应的基表。但是当对视图中的数据进行增加、删除和修改操作时，数据表中的数据会相应地发生变化，反之亦然</li>
<li>向视图提供数据内容的语句为 SELECT 语句，可以将视图理解为<strong>存储起来的 SELECT 语句</strong></li>
</ul>
<h3 id="创建视图"><a class="anchor" href="#创建视图">#</a> 创建视图</h3>
<ul>
<li>
<p>精简版</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> 视图名称<span class="token punctuation">(</span>列表<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">AS</span> 查询语句<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> emp_year_salary <span class="token punctuation">(</span>ename<span class="token punctuation">,</span>year_salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">AS</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">SELECT</span> ename<span class="token punctuation">,</span>salary<span class="token operator">*</span><span class="token number">12</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">FROM</span> t_employee<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> salvu50</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">AS</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">SELECT</span>  employee_id ID_NUMBER<span class="token punctuation">,</span> last_name NAME<span class="token punctuation">,</span>salary<span class="token operator">*</span><span class="token number">12</span> ANN_SALARY</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">FROM</span>    employees</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">WHERE</span>   department_id <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<p>多表也如此</p>
</li>
</ul>
</li>
<li>
<p>基于视图创建视图以此类推</p>
</li>
</ul>
<h3 id="查看视图"><a class="anchor" href="#查看视图">#</a> 查看视图</h3>
<ul>
<li>查看数据库的表对象、视图对象
<ul>
<li><code>SHOW TABLES;</code></li>
</ul>
</li>
<li>查看视图的结构
<ul>
<li><code>DESC 视图名称;</code></li>
</ul>
</li>
<li>查看视图的属性信息
<ul>
<li><code>SHOW TABLE STATUS LIKE '视图名称';</code></li>
</ul>
</li>
<li>查看视图的详细定义信息
<ul>
<li><code>SHOW CREATE VIEW 视图名称;</code></li>
</ul>
</li>
</ul>
<h3 id="更新视图"><a class="anchor" href="#更新视图">#</a> 更新视图</h3>
<ul>
<li>视图作为虚拟表，主要用于<strong>方便查询</strong>，<strong>不建议</strong>更新视图的数据。对视图数据的更改，都是通过对<strong>实际数据表</strong>里数据的操作来完成的</li>
</ul>
<h3 id="修改-删除视图"><a class="anchor" href="#修改-删除视图">#</a> 修改 删除视图</h3>
<h4 id="修改视图"><a class="anchor" href="#修改视图">#</a> 修改视图</h4>
<ul>
<li>
<p>方式一</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> 视图名称</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">AS</span> </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">SELECT</span> 语句<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>方式二</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">VIEW</span> 视图名称 </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">AS</span></pre></td></tr><tr><td data-num="3"></td><td><pre>查询语句<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h4 id="删除视图"><a class="anchor" href="#删除视图">#</a> 删除视图</h4>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> 视图名称<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> 视图名称<span class="token number">1</span><span class="token punctuation">,</span>视图名称<span class="token number">2</span><span class="token punctuation">,</span>视图名称<span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="存储过程-函数"><a class="anchor" href="#存储过程-函数">#</a> 存储过程、函数</h2>
<h3 id="存储过程"><a class="anchor" href="#存储过程">#</a> 存储过程</h3>
<h4 id="基本介绍-2"><a class="anchor" href="#基本介绍-2">#</a> 基本介绍</h4>
<ul>
<li>一组经过预先编译的 SQL 语句的封装</li>
<li>存储过程是程序化的 SQL，可以直接操作底层数据表</li>
<li>存储过程没有返回值</li>
<li>分类
<ul>
<li>没有参数（无参数无返回）</li>
<li>仅仅带 IN 类型（有参数无返回）</li>
<li>仅仅带 OUT 类型（无参数有返回）</li>
<li>既带 IN 又带 OUT（有参数有返回）</li>
<li>带 INOUT（有参数有返回）</li>
<li>IN、OUT、INOUT 都可以在一个存储过程中带多个</li>
</ul>
</li>
</ul>
<h4 id="创建存储过程"><a class="anchor" href="#创建存储过程">#</a> 创建存储过程</h4>
<ul>
<li>
<p><code>IN</code>  ：当前参数为输入参数，也就是表示入参；如果没有定义参数种类， 默认就是 IN</p>
</li>
<li>
<p><code>OUT</code>  ：当前参数为输出参数，也就是表示出参</p>
</li>
<li>
<p><code>INOUT</code>  ：当前参数既可以为输入参数，也可以为输出参数</p>
</li>
<li>
<p>形参类型可以是 sql 数据库中的任意类型。</p>
</li>
<li>
<p><code>characteristics</code>   表示创建存储过程时指定的对存储过程的约束条件，其取值信息如下：</p>
</li>
<li>
<p><code>LANGUAGE SQL</code>  ：说明存储过程执行体是由 SQL 语句组成的，当前系统支持的语言为 SQL。</p>
</li>
<li>
<p><code>[NOT] DETERMINISTIC</code>  ：指明存储过程执行的结果是否确定。DETERMINISTIC 表示结果是确定的。每次执行存储过程时，相同的输入会得到相同的输出。NOT DETERMINISTIC 表示结果是不确定的，相同的输入可能得到不同的输出。如果没有指定任意一个值，默认为 NOT DETERMINISTIC。</p>
</li>
<li>
<p><code>&#123; CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA &#125;</code>  ：指明子程序使用 SQL 语句的限制。</p>
<ul>
<li>
<p>CONTAINS SQL 表示当前存储过程的子程序包含 SQL 语句，但是并不包含读写数据的 SQL 语句；</p>
</li>
<li>
<p>NO SQL 表示当前存储过程的子程序中不包含任何 SQL 语句；</p>
</li>
<li>
<p>READS SQL DATA 表示当前存储过程的子程序中包含读数据的 SQL 语句；</p>
</li>
<li>
<p>MODIFIES SQL DATA 表示当前存储过程的子程序中包含写数据的 SQL 语句。</p>
</li>
<li>
<p>默认情况下，系统会指定为 CONTAINS SQL。</p>
</li>
</ul>
</li>
<li>
<p><code>SQL SECURITY &#123; DEFINER | INVOKER &#125;</code>  ：执行当前存储过程的权限，即指明哪些用户能够执行当前存储过程。</p>
<ul>
<li>DEFINER 表示只有当前存储过程的创建者或者定义者才能执行当前存储过程；</li>
<li>INVOKER 表示拥有当前存储过程的访问权限的用户能够执行当前存储过程。如果没有设置相关的值，则 sql 默认指定值为 DEFINER。</li>
</ul>
</li>
<li>
<p><code>COMMENT 'string'</code>  ：注释信息，可以用来描述存储过程。</p>
</li>
<li>
<p>需要设置新的结束标记</p>
<ul>
<li>因为 sql 默认的语句结束符号为分号‘;’。为了避免与存储过程中 SQL 语句结束符相冲突，需要使用 <code>DELIMITER</code>  改变存储过程的结束符。<br>
比如：“DELIMITER //” 语句的作用是将 sql 的结束符设置为 //，并以 “END //” 结束存储过程。存储过程定义完毕之后再使用 “DELIMITER ;” 恢复默认结束符。</li>
<li>DELIMITER 也可以指定其他符号作为结束符。当使用 DELIMITER 命令时，应该避免使用反斜杠（‘\’）字符，因为反斜线是 sql 的转义字符</li>
</ul>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DELIMITER</span> $</pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> select_all_data<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  </pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> emps<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">END</span> $</pre></td></tr><tr><td data-num="7"></td><td><pre>  </pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">call</span> select_all_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> show_min_salary<span class="token punctuation">(</span><span class="token keyword">OUT</span> ms <span class="token keyword">DOUBLE</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>      <span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="4"></td><td><pre>          <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">INTO</span> ms <span class="token keyword">FROM</span> emps<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token keyword">END</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  </pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">call</span> show_min_salary<span class="token punctuation">(</span><span class="token variable">@ms</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">SELECT</span> <span class="token variable">@ms</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> show_someone_salary<span class="token punctuation">(</span><span class="token operator">IN</span> empname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>      <span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="4"></td><td><pre>          <span class="token keyword">SELECT</span> salary <span class="token keyword">FROM</span> emps <span class="token keyword">WHERE</span> ename <span class="token operator">=</span> empname<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token keyword">END</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">call</span> show_someone_salary<span class="token punctuation">(</span><span class="token string">'Jack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> show_mgr_name<span class="token punctuation">(</span><span class="token keyword">INOUT</span> empname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>      <span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="4"></td><td><pre>          <span class="token keyword">SELECT</span> ename <span class="token keyword">INTO</span> empname <span class="token keyword">FROM</span> emps</pre></td></tr><tr><td data-num="5"></td><td><pre>          <span class="token keyword">WHERE</span> eid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> MID <span class="token keyword">FROM</span> emps <span class="token keyword">WHERE</span> ename<span class="token operator">=</span>empname<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token keyword">END</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token comment">#使用变量</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">SET</span> <span class="token variable">@name</span> <span class="token operator">=</span> <span class="token string">'Jack'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">call</span> show_mgr_name<span class="token punctuation">(</span><span class="token variable">@name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">select</span> <span class="token variable">@name</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h3 id="存储函数"><a class="anchor" href="#存储函数">#</a> 存储函数</h3>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> 函数名<span class="token punctuation">(</span>参数名 参数类型<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">RETURNS</span> 返回值类型</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>characteristics <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    函数体   <span class="token comment">#函数体中肯定有 RETURN 语句</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">END</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">#调用函数</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">SELECT</span> 函数名<span class="token punctuation">(</span>实参列表<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<p>FUNCTION 中总是默认为 <code>IN</code>  参数。</p>
</li>
<li>
<p><code>RETURNS type;</code>  语句表示函数返回数据的类型</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> email_by_id<span class="token punctuation">(</span>emp_id <span class="token keyword">INT</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">RETURNS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">DETERMINISTIC</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">CONTAINS</span> <span class="token keyword">SQL</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">RETURN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> email <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> emp_id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">END</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">SET</span> <span class="token variable">@emp_id</span> <span class="token operator">=</span> <span class="token number">102</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">SELECT</span> email_by_id<span class="token punctuation">(</span><span class="token variable">@emp_id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h3 id="对比"><a class="anchor" href="#对比">#</a> 对比</h3>
<table>
<thead>
<tr>
<th></th>
<th>关键字</th>
<th>调用语法</th>
<th>返回值</th>
<th>应用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td>存储过程</td>
<td>PROCEDURE</td>
<td>CALL</td>
<td>理解为有 0 个或多个</td>
<td>一般用于更新</td>
</tr>
<tr>
<td>存储函数</td>
<td>FUNCTION</td>
<td>SELECT</td>
<td>只能是一个</td>
<td>一般用于查询结果为一个值并返回时</td>
</tr>
</tbody>
</table>
<h3 id="修改"><a class="anchor" href="#修改">#</a> 修改</h3>
<ul>
<li>
<p>只是修改相关特性</p>
</li>
<li>
<p>修改存储过程使用 ALTER PROCEDURE 语句，修改存储函数使用 ALTER FUNCTION 语句</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">PROCEDURE</span> CountProc</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">MODIFIES</span> <span class="token keyword">SQL</span> <span class="token keyword">DATA</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">SQL</span> SECURITY <span class="token keyword">INVOKER</span> <span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h3 id="删除"><a class="anchor" href="#删除">#</a> 删除</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> CountProc<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">FUNCTION</span> CountProc<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="变量-流程控制-游标"><a class="anchor" href="#变量-流程控制-游标">#</a> 变量 流程控制 游标</h2>
<h3 id="变量"><a class="anchor" href="#变量">#</a> 变量</h3>
<h4 id="基本介绍-3"><a class="anchor" href="#基本介绍-3">#</a> 基本介绍</h4>
<ul>
<li>变量分为 系统变量 用户自定义变量</li>
</ul>
<h3 id="系统变量"><a class="anchor" href="#系统变量">#</a> 系统变量</h3>
<ul>
<li>属于服务器层面</li>
<li>全局系统变量（需要添加<strong> global</strong> 关键字）</li>
<li>会话系统变量（需要添加<strong> session</strong> 关键字）</li>
<li>如果不写，默认会话级别</li>
<li>全局系统变量针对于所有会话（连接）有效，但不能跨重启</li>
<li>会话系统变量仅针对于当前会话（连接）有效</li>
</ul>
<h4 id="查看系统变量"><a class="anchor" href="#查看系统变量">#</a> 查看系统变量</h4>
<ul>
<li>查看所有或部分系统变量</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#查看所有全局变量</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">GLOBAL</span> VARIABLES<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#查看所有会话变量</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">SESSION</span> VARIABLES<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>或</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">SHOW</span> VARIABLES<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">#查看满足条件的部分系统变量。</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">GLOBAL</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%标识符%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">#查看满足条件的部分会话变量</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">SESSION</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%标识符%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">#例</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">GLOBAL</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'admin_%'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul>
<li>查看指定系统变量
<ul>
<li>sql 中的系统变量以 两个 “@” 开头</li>
<li>“@@global” 仅用于标记全局系统变量</li>
<li>“@@session” 仅用于标记会话系统变量</li>
<li>“@@” 首先标记会话系统变量，如果会话系统变量不存在，<br>
则标记全局系统变量</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#查看指定的系统变量的值</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> @<span class="token variable">@global.</span>变量名<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#查看指定的会话变量的值</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">SELECT</span> @<span class="token variable">@session.</span>变量名<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">#或者</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">SELECT</span> @@变量名<span class="token punctuation">;</span></pre></td></tr></table></figure><ul>
<li>修改系统变量的值
<ul>
<li>修改 sql 配置文件 ，继而修改 sql 系统变量的值（该方法需要重启 sql 服务）</li>
<li>在 sql 服务运行期间，使用 “set” 命令重新设置系统变量的值</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#为某个系统变量赋值</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">#方式 1：</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#SET @@global. 变量名 = 变量值；</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#方式 2：</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> 变量名<span class="token operator">=</span>变量值<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">#为某个会话变量赋值</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">#方式 1：</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">#SET @@session. 变量名 = 变量值；</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">#方式 2：</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">SET</span> <span class="token keyword">SESSION</span> 变量名<span class="token operator">=</span>变量值<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="用户变量"><a class="anchor" href="#用户变量">#</a> 用户变量</h3>
<ul>
<li>会话用户变量：作用域和会话变量一样，只对<strong>当前连接会话</strong>有效。</li>
<li>局部变量：只在 BEGIN 和 END 语句块中有效。局部变量只能在<strong>存储过程和函数</strong>中使用</li>
</ul>
<h4 id="会话用户变量"><a class="anchor" href="#会话用户变量">#</a> 会话用户变量</h4>
<ul>
<li>变量的定义</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#方式 1：“=” 或 “:=”</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SET</span> @用户变量 <span class="token operator">=</span> 值<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#SET @用户变量 := 值；</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#方式 2：“:=” 或 INTO 关键字</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#SELECT @用户变量 := 表达式 [FROM 等子句];</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">SELECT</span> 表达式 <span class="token keyword">INTO</span> @用户变量  <span class="token punctuation">[</span><span class="token keyword">FROM</span> 等子句<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#SELECT @num := COUNT(*) FROM employees;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">#SELECT @num;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">INTO</span> <span class="token variable">@avgsalary</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">SELECT</span> <span class="token variable">@avgsalary</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul>
<li>查看用户变量的值: <code>SELECT @用户变量;</code></li>
</ul>
<h4 id="局部变量"><a class="anchor" href="#局部变量">#</a> 局部变量</h4>
<ul>
<li>可以使用 DECLARE 语句定义一个局部变量</li>
<li>作用域：仅仅在定义它的 BEGIN ... END 中有效</li>
<li>只能放在 BEGIN ... END 中，而且只能放在首部</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment">#声明局部变量</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">#如果没有 DEFAULT 子句，初始值为 NULL</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">DECLARE</span> 变量名<span class="token number">1</span> 变量数据类型 <span class="token punctuation">[</span><span class="token keyword">DEFAULT</span> 变量默认值<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">DECLARE</span> 变量名<span class="token number">2</span><span class="token punctuation">,</span>变量名<span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 变量数据类型 <span class="token punctuation">[</span><span class="token keyword">DEFAULT</span> 变量默认值<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">#为局部变量赋值</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">#一般用于赋简单的值</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">SET</span> 变量名<span class="token number">1</span> <span class="token operator">=</span> 值<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token comment">#一般用于赋表中的字段值</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">SELECT</span> 值 <span class="token keyword">INTO</span> 变量名<span class="token number">2</span> <span class="token punctuation">[</span><span class="token keyword">FROM</span> 子句<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token comment">#查看局部变量的值</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">SELECT</span> 变量<span class="token number">1</span><span class="token punctuation">,</span>变量<span class="token number">2</span><span class="token punctuation">,</span>变量<span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">END</span></pre></td></tr></table></figure><h2 id="定义条件与处理程序"><a class="anchor" href="#定义条件与处理程序">#</a> 定义条件与处理程序</h2>
<h3 id="定义条件"><a class="anchor" href="#定义条件">#</a> 定义条件</h3>
<ul>
<li>
<p>给 sql 中的错误码命名</p>
</li>
<li>
<p>将一个错误名字和指定的错误条件关联</p>
</li>
<li>
<p><code>DECLARE 错误名称 CONDITION FOR 错误码（或错误条件）;</code></p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#使用 sql_error_code</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">DECLARE</span> Field_Not_Be_NULL CONDITION <span class="token keyword">FOR</span> <span class="token number">1048</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#使用 sqlstate_value</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">DECLARE</span> Field_Not_Be_NULL CONDITION <span class="token keyword">FOR</span> SQLSTATE <span class="token string">'23000'</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h3 id="处理程序"><a class="anchor" href="#处理程序">#</a> 处理程序</h3>
<ul>
<li><code>DECLARE 处理方式 HANDLER FOR 错误类型 处理语句</code></li>
<li>处理方式
<ul>
<li>处理方式有 3 个取值：CONTINUE、EXIT、UNDO。</li>
<li>CONTINUE ：表示遇到错误不处理，继续执行。</li>
<li>EXIT ：表示遇到错误马上退出。</li>
<li>UNDO ：表示遇到错误后撤回之前的操作。sql 中暂时不支持这样的操作</li>
</ul>
</li>
<li>错误类型（即条件）
<ul>
<li><code>SQLSTATE '字符串错误码'</code>  ：表示长度为 5 的 sqlstate_value 类型的错误代码；</li>
<li><code>sql_error_code</code>  ：匹配数值类型错误代码；</li>
<li>错误名称 ：表示 DECLARE ... CONDITION 定义的错误条件名称。</li>
<li><code>SQLWARNING</code>  ：匹配所有以 01 开头的 SQLSTATE 错误代码；</li>
<li><code>NOT FOUND</code> ：匹配所有以 02 开头的 SQLSTATE 错误代码；</li>
<li><code>SQLEXCEPTION</code>  ：匹配所有没有被 SQLWARNING 或 NOT FOUND 捕获的 SQLSTATE 错误代码</li>
</ul>
</li>
<li>处理语句
<ul>
<li><code>SET 变量 = 值 ;</code></li>
<li><code>BEGIN ... END</code></li>
</ul>
</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#方法 1：捕获 sqlstate_value</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">DECLARE</span> <span class="token keyword">CONTINUE</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> SQLSTATE <span class="token string">'42S02'</span> <span class="token keyword">SET</span> <span class="token variable">@info</span> <span class="token operator">=</span> <span class="token string">'NO_SUCH_TABLE'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#方法 2：捕获 sql_error_value</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">DECLARE</span> <span class="token keyword">CONTINUE</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> <span class="token number">1146</span> <span class="token keyword">SET</span> <span class="token variable">@info</span> <span class="token operator">=</span> <span class="token string">'NO_SUCH_TABLE'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#方法 3：先定义条件，再调用</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">DECLARE</span> no_such_table CONDITION <span class="token keyword">FOR</span> <span class="token number">1146</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">DECLARE</span> <span class="token keyword">CONTINUE</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> NO_SUCH_TABLE <span class="token keyword">SET</span> <span class="token variable">@info</span> <span class="token operator">=</span> <span class="token string">'NO_SUCH_TABLE'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">#方法 4：使用 SQLWARNING</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">DECLARE</span> <span class="token keyword">EXIT</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> SQLWARNING <span class="token keyword">SET</span> <span class="token variable">@info</span> <span class="token operator">=</span> <span class="token string">'ERROR'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">#方法 5：使用 NOT FOUND</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">DECLARE</span> <span class="token keyword">EXIT</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> <span class="token operator">NOT</span> FOUND <span class="token keyword">SET</span> <span class="token variable">@info</span> <span class="token operator">=</span> <span class="token string">'NO_SUCH_TABLE'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">#方法 6：使用 SQLEXCEPTION</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">DECLARE</span> <span class="token keyword">EXIT</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> SQLEXCEPTION <span class="token keyword">SET</span> <span class="token variable">@info</span> <span class="token operator">=</span> <span class="token string">'ERROR'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="流程控制"><a class="anchor" href="#流程控制">#</a> 流程控制</h2>
<h3 id="分支结构之-if"><a class="anchor" href="#分支结构之-if">#</a> 分支结构之 IF</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">IF</span> 表达式<span class="token number">1</span> <span class="token keyword">THEN</span> 操作<span class="token number">1</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span><span class="token keyword">ELSEIF</span> 表达式<span class="token number">2</span> <span class="token keyword">THEN</span> 操作<span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span><span class="token keyword">ELSE</span> 操作N<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul>
<li>声明存储过程 “update_salary_by_eid1”，定义 IN 参数 emp_id，输入员工编号。判断该员工薪资如果低于 8000 元并且入职时间超过 5 年，就涨薪 500 元；否则就不变</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> update_salary_by_eid1<span class="token punctuation">(</span><span class="token operator">IN</span> emp_id <span class="token keyword">INT</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token keyword">DECLARE</span> emp_salary <span class="token keyword">DOUBLE</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">DECLARE</span> hire_year <span class="token keyword">DOUBLE</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">SELECT</span> salary <span class="token keyword">INTO</span> emp_salary <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> emp_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">SELECT</span> DATEDIFF<span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>hire_date<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">365</span> <span class="token keyword">INTO</span> hire_year</pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> emp_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">IF</span> emp_salary <span class="token operator">&lt;</span> <span class="token number">8000</span> <span class="token operator">AND</span> hire_year <span class="token operator">></span> <span class="token number">5</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">THEN</span> <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">+</span> <span class="token number">500</span> <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> emp_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">END</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="分支结构之-case"><a class="anchor" href="#分支结构之-case">#</a> 分支结构之 CASE</h3>
<ul>
<li>
<p>类似于 switch</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CASE</span> 表达式</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">WHEN</span> 值<span class="token number">1</span> <span class="token keyword">THEN</span> 结果<span class="token number">1</span>或语句<span class="token number">1</span><span class="token punctuation">(</span>如果是语句，需要加分号<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">WHEN</span> 值<span class="token number">2</span> <span class="token keyword">THEN</span> 结果<span class="token number">2</span>或语句<span class="token number">2</span><span class="token punctuation">(</span>如果是语句，需要加分号<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">ELSE</span> 结果n或语句n<span class="token punctuation">(</span>如果是语句，需要加分号<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">END</span> <span class="token punctuation">[</span><span class="token keyword">case</span><span class="token punctuation">]</span>（如果是放在<span class="token keyword">begin</span> <span class="token keyword">end</span>中需要加上<span class="token keyword">case</span>，如果放在<span class="token keyword">select</span>后面不需要）</pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>类似于多重 if</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CASE</span> </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">WHEN</span> 条件<span class="token number">1</span> <span class="token keyword">THEN</span> 结果<span class="token number">1</span>或语句<span class="token number">1</span><span class="token punctuation">(</span>如果是语句，需要加分号<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">WHEN</span> 条件<span class="token number">2</span> <span class="token keyword">THEN</span> 结果<span class="token number">2</span>或语句<span class="token number">2</span><span class="token punctuation">(</span>如果是语句，需要加分号<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">ELSE</span> 结果n或语句n<span class="token punctuation">(</span>如果是语句，需要加分号<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">END</span> <span class="token punctuation">[</span><span class="token keyword">case</span><span class="token punctuation">]</span>（如果是放在<span class="token keyword">begin</span> <span class="token keyword">end</span>中需要加上<span class="token keyword">case</span>，如果放在<span class="token keyword">select</span>后面不需要）</pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>声明存储过程 “update_salary_by_eid4”，定义 IN 参数 emp_id，输入员工编号。判断该员工薪资如果低于 9000 元，就更新薪资为 9000 元；薪资大于等于 9000 元且低于 10000 的，但是奖金比例为 NULL 的，就更新奖金比例为 0.01；其他的涨薪 100 元</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> update_salary_by_eid4<span class="token punctuation">(</span><span class="token operator">IN</span> emp_id <span class="token keyword">INT</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">DECLARE</span> emp_sal <span class="token keyword">DOUBLE</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">DECLARE</span> bonus <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">SELECT</span> salary <span class="token keyword">INTO</span> emp_sal <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> emp_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">SELECT</span> commission_pct <span class="token keyword">INTO</span> bonus <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> emp_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">CASE</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">WHEN</span> emp_sal<span class="token operator">&lt;</span><span class="token number">9000</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">THEN</span> <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary<span class="token operator">=</span><span class="token number">9000</span> <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> emp_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">WHEN</span> emp_sal<span class="token operator">&lt;</span><span class="token number">10000</span> <span class="token operator">AND</span> bonus <span class="token operator">IS</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">THEN</span> <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> commission_pct<span class="token operator">=</span><span class="token number">0.01</span> <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> emp_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">ELSE</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary<span class="token operator">=</span>salary<span class="token operator">+</span><span class="token number">100</span> <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> emp_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">END</span> <span class="token keyword">CASE</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">END</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="循环结构之loop"><a class="anchor" href="#循环结构之loop">#</a> 循环结构之 LOOP</h3>
<ul>
<li>loop_label 表示 LOOP 语句的标注名称，该参数可以省略</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>loop_label:<span class="token punctuation">]</span> <span class="token keyword">LOOP</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    循环执行的语句</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">END</span> <span class="token keyword">LOOP</span> <span class="token punctuation">[</span>loop_label<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul>
<li>
<p>使用 LOOP 语句进行循环操作，id 值小于 10 时将重复执行循环过程</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DECLARE</span> id <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>add_loop:<span class="token keyword">LOOP</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">SET</span> id <span class="token operator">=</span> id <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">IF</span> id <span class="token operator">>=</span> <span class="token number">10</span> <span class="token keyword">THEN</span> <span class="token keyword">LEAVE</span> add_loop<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">END</span> <span class="token keyword">LOOP</span> add_loop<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="循环结构之while"><a class="anchor" href="#循环结构之while">#</a> 循环结构之 WHILE</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>while_label:<span class="token punctuation">]</span> <span class="token keyword">WHILE</span> 循环条件  <span class="token keyword">DO</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    循环体</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">END</span> <span class="token keyword">WHILE</span> <span class="token punctuation">[</span>while_label<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">WHILE</span> avg_sal <span class="token operator">></span> <span class="token number">5000</span> <span class="token keyword">DO</span></pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        </pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">SET</span> while_count <span class="token operator">=</span> while_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        </pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">INTO</span> avg_sal <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">END</span> <span class="token keyword">WHILE</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="循环结构之repeat"><a class="anchor" href="#循环结构之repeat">#</a> 循环结构之 REPEAT</h3>
<ul>
<li>REPEAT 循环首先会执行一次循环</li>
</ul>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>repeat_label:<span class="token punctuation">]</span> <span class="token keyword">REPEAT</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    循环体的语句</pre></td></tr><tr><td data-num="3"></td><td><pre>UNTIL 结束循环的条件表达式<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">END</span> <span class="token keyword">REPEAT</span> <span class="token punctuation">[</span>repeat_label<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">REPEAT</span></pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.15</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        </pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">SET</span> repeat_count <span class="token operator">=</span> repeat_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        </pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">INTO</span> avg_sal <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    UNTIL avg_sal <span class="token operator">>=</span> <span class="token number">13000</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">END</span> <span class="token keyword">REPEAT</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="跳转语句之leave语句"><a class="anchor" href="#跳转语句之leave语句">#</a> 跳转语句之 LEAVE 语句</h3>
<ul>
<li>
<p>LEAVE 语句：可以用在循环语句内，或者以 BEGIN 和 END 包裹起来的程序体内，表示跳出循环或者跳出程序体的操作 (break)</p>
</li>
<li>
<p><code>LEAVE 标记名;</code></p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#循环条件</span></pre></td></tr><tr><td data-num="2"></td><td><pre>while_label:<span class="token keyword">WHILE</span> <span class="token boolean">TRUE</span> <span class="token keyword">DO</span> </pre></td></tr><tr><td data-num="3"></td><td><pre>        </pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token comment">#循环体</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">IF</span> avg_sal <span class="token operator">&lt;=</span> <span class="token number">10000</span> <span class="token keyword">THEN</span></pre></td></tr><tr><td data-num="6"></td><td><pre>            <span class="token keyword">LEAVE</span> while_label<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        </pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary  <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">SET</span> while_count <span class="token operator">=</span> while_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        </pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token comment">#迭代条件</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">INTO</span> avg_sal <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    </pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">END</span> <span class="token keyword">WHILE</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h3 id="跳转语句之iterate语句"><a class="anchor" href="#跳转语句之iterate语句">#</a> 跳转语句之 ITERATE 语句</h3>
<ul>
<li>
<p>只能用在循环语句（LOOP、REPEAT 和 WHILE 语句）内，表示重新开始循环 (continue)</p>
</li>
<li>
<p><code>ITERATE label;</code></p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre>my_loop:<span class="token keyword">LOOP</span></pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token keyword">SET</span> num <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    </pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">IF</span> num <span class="token operator">&lt;</span> <span class="token number">10</span> </pre></td></tr><tr><td data-num="5"></td><td><pre>            <span class="token keyword">THEN</span> <span class="token keyword">ITERATE</span> my_loop<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">ELSEIF</span> num <span class="token operator">></span> <span class="token number">15</span> </pre></td></tr><tr><td data-num="7"></td><td><pre>		<span class="token keyword">THEN</span> <span class="token keyword">LEAVE</span> my_loop<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    </pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">SELECT</span> <span class="token string">'尚硅谷：让天下没有难学的技术'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    </pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">END</span> <span class="token keyword">LOOP</span> my_loop<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h3 id="游标光标"><a class="anchor" href="#游标光标">#</a> 游标 (光标)</h3>
<ul>
<li>
<p>随意定位到某一条记录，并对记录的数据进行处理</p>
</li>
<li>
<p>游标是一种临时的数据库对象，可以指向存储在数据库表中的数据行指针</p>
</li>
<li>
<p>使用游标步骤</p>
<p>游标必须在声明处理程序之前被声明，并且变量和条件还必须在声明游标或处理程序之前被声明</p>
<ul>
<li>声明游标
<ul>
<li><code>DECLARE cursor_name CURSOR FOR select_statement;</code></li>
</ul>
</li>
<li>打开游标
<ul>
<li><code>OPEN cursor_name;</code></li>
</ul>
</li>
<li>使用游标（从游标中取得数据）
<ul>
<li><code>FETCH cursor_name INTO var_name [, var_name] ...</code></li>
<li>这句的作用是使用 cursor_name 这个游标来读取当前行，并且将数据保存到 var_name 这个变量中，游标指针指到下一行。如果游标读取的数据行有多个列名，则在 INTO 关键字后面赋值给多个变量名即可</li>
<li>var_name 必须在声明游标之前就定义好</li>
<li><code>FETCH cur_emp INTO emp_id, emp_sal ;</code></li>
<li>游标的查询结果集中的字段数，必须跟 INTO 后面的变量数一致</li>
</ul>
</li>
<li>关闭游标
<ul>
<li><code>CLOSE cursor_name;</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>创建存储过程 “get_count_by_limit_total_salary ()”，声明 IN 参数 limit_total_salary，DOUBLE 类型；声明 OUT 参数 total_count，INT 类型。函数的功能可以实现累加薪资最高的几个员工的薪资值，直到薪资总和达到 limit_total_salary 参数的值，返回累加的人数给 total_count</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> get_count_by_limit_total_salary<span class="token punctuation">(</span><span class="token operator">IN</span> limit_total_salary <span class="token keyword">DOUBLE</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> </pre></td></tr><tr><td data-num="3"></td><td><pre>total_count <span class="token keyword">INT</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">DECLARE</span> sum_salary <span class="token keyword">DOUBLE</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">#记录累加的总工资</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">DECLARE</span> cursor_salary <span class="token keyword">DOUBLE</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">#记录某一个工资值</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">DECLARE</span> emp_count <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">#记录循环个数</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token comment">#定义游标</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">DECLARE</span> emp_cursor <span class="token keyword">CURSOR</span> <span class="token keyword">FOR</span> <span class="token keyword">SELECT</span> salary <span class="token keyword">FROM</span> employees <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token comment">#打开游标</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">OPEN</span> emp_cursor<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    </pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">REPEAT</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment">#使用游标（从游标中获取数据）</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">FETCH</span> emp_cursor <span class="token keyword">INTO</span> cursor_salary<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        </pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">SET</span> sum_salary <span class="token operator">=</span> sum_salary <span class="token operator">+</span> cursor_salary<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">SET</span> emp_count <span class="token operator">=</span> emp_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        </pre></td></tr><tr><td data-num="20"></td><td><pre>        UNTIL sum_salary <span class="token operator">>=</span> limit_total_salary</pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">END</span> <span class="token keyword">REPEAT</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    </pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">SET</span> total_count <span class="token operator">=</span> emp_count<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token comment">#关闭游标</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">CLOSE</span> emp_cursor<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    </pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">END</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>逐条读取结果集中的数据</p>
</li>
</ul>
<h2 id="触发器"><a class="anchor" href="#触发器">#</a> 触发器</h2>
<ul>
<li>
<p>你可以创建一个触发器，让商品信息数据的插入操作自动触发库存数<br>
据的插入操作</p>
</li>
<li>
<p>触发器是由 事件来触发 某个操作，这些事件包括 INSERT 、 UPDATE 、 DELETE 事件。所谓事件就是指用户的动作或者触发某项行为。如果定义了触发程序，当数据库执行这些语句时候，就相当于事件发生了，就会自动激发触发器执行相应的操作</p>
</li>
</ul>
<h3 id="触发器的创建"><a class="anchor" href="#触发器的创建">#</a> 触发器的创建</h3>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> 触发器名称 </pre></td></tr><tr><td data-num="2"></td><td><pre>&#123;BEFORE<span class="token operator">|</span><span class="token keyword">AFTER</span>&#125; &#123;<span class="token keyword">INSERT</span><span class="token operator">|</span><span class="token keyword">UPDATE</span><span class="token operator">|</span><span class="token keyword">DELETE</span>&#125; <span class="token keyword">ON</span> 表名 </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">FOR EACH ROW</span> </pre></td></tr><tr><td data-num="4"></td><td><pre>触发器执行的语句块<span class="token punctuation">;</span></pre></td></tr></table></figure><ul>
<li>表名 ：表示触发器监控的对象。</li>
<li>BEFORE|AFTER ：表示触发的时间。BEFORE 表示在事件之前触发；AFTER 表示在事件之后触发。</li>
<li>INSERT|UPDATE|DELETE ：表示触发的事件。
<ul>
<li>INSERT 表示插入记录时触发；</li>
<li>UPDATE 表示更新记录时触发；</li>
<li>DELETE 表示删除记录时触发。</li>
</ul>
</li>
<li>触发器执行的语句块 ：可以是单条 SQL 语句，也可以是由 BEGIN...END 结构组成的复合语句块</li>
</ul>
<h4 id="举例"><a class="anchor" href="#举例">#</a> 举例</h4>
<ul>
<li>
<p>创建表</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_trigger <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>t_note <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_trigger_log <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="6"></td><td><pre>id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>t_log <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>创建触发器：创建名称为 before_insert 的触发器，向 test_trigger 数据表插入数据之前，向 test_trigger_log 数据表中插入 before_insert 的日志信息</p>
<ul>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> before_insert</pre></td></tr><tr><td data-num="3"></td><td><pre>BEFORE <span class="token keyword">INSERT</span> <span class="token keyword">ON</span> test_trigger </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">FOR EACH ROW</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">BEGIN</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_trigger_log <span class="token punctuation">(</span>t_log<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'before_insert'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">END</span> <span class="token comment">//</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="查看触发器"><a class="anchor" href="#查看触发器">#</a> 查看触发器</h3>
<ul>
<li>查看当前数据库的所有触发器的定义
<ul>
<li>SHOW TRIGGERS;</li>
</ul>
</li>
<li>查看当前数据库中某个触发器的定义
<ul>
<li>SHOW CREATE TRIGGER 触发器名；</li>
</ul>
</li>
<li>从系统库 information_schema 的 TRIGGERS 表中查询触发器的信息
<ul>
<li>SELECT * FROM information_schema.TRIGGERS;</li>
</ul>
</li>
</ul>
<h3 id="删除触发器"><a class="anchor" href="#删除触发器">#</a> 删除触发器</h3>
<ul>
<li>DROP TRIGGER  IF EXISTS 触发器名称；</li>
</ul>
<h2 id="sql80新特性"><a class="anchor" href="#sql80新特性">#</a> sql8.0 新特性</h2>
<h3 id="窗口函数"><a class="anchor" href="#窗口函数">#</a> 窗口函数</h3>
<h4 id="基本介绍-4"><a class="anchor" href="#基本介绍-4">#</a> 基本介绍</h4>
<ul>
<li><code>函数 OVER (PARTITION BY 字段名 ORDER BY 字段名 ASC|DESC)</code></li>
<li>PARTITION BY 子句：指定窗口函数按照哪些字段进行分组。分组后，窗口函数可以在每个分组中分<br>
别执行。</li>
<li>ORDER BY 子句：指定窗口函数按照哪些字段进行排序。执行排序操作使窗口函数按照排序后的数据<br>
记录的顺序进行编号</li>
</ul>
<h4 id="序号函数-row_number函数"><a class="anchor" href="#序号函数-row_number函数">#</a> 序号函数 - ROW_NUMBER () 函数</h4>
<ul>
<li>
<p>ROW_NUMBER () 函数能够对数据中的序号进行顺序显示</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span><span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span></pre></td></tr><tr><td data-num="2"></td><td><pre>row_num<span class="token punctuation">,</span>id<span class="token punctuation">,</span> category_id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> stock</pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">FROM</span> goods<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h4 id="序号函数-rank函数"><a class="anchor" href="#序号函数-rank函数">#</a> 序号函数 - RANK () 函数</h4>
<ul>
<li>
<p>使用 RANK () 函数能够对序号进行并列排序，并且会跳过重复的序号，比如序号为 1、1、3</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> RANK<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span><span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span></pre></td></tr><tr><td data-num="2"></td><td><pre>row_num<span class="token punctuation">,</span>id<span class="token punctuation">,</span> category_id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> stock</pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">FROM</span> goods<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h4 id="序号函数-dense_rank函数"><a class="anchor" href="#序号函数-dense_rank函数">#</a> 序号函数 - DENSE_RANK () 函数</h4>
<ul>
<li>
<p>DENSE_RANK () 函数对序号进行并列排序，并且不会跳过重复的序号，比如序号为 1、1、2</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span><span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span></pre></td></tr><tr><td data-num="2"></td><td><pre>row_num<span class="token punctuation">,</span>id<span class="token punctuation">,</span> category_id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> stock</pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">FROM</span> goods<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h4 id="分布函数-percent_rank函数"><a class="anchor" href="#分布函数-percent_rank函数">#</a> 分布函数 - PERCENT_RANK () 函数</h4>
<ul>
<li>
<p>PERCENT_RANK () 函数是等级值百分比函数</p>
</li>
<li>
<p>(rank - 1) / (rows - 1)</p>
<ul>
<li>rank 的值为使用 RANK () 函数产生的序号，rows 的值为当前窗口的总记录数</li>
</ul>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> RANK<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span><span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> rank_num<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    PERCENT_RANK<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price <span class="token keyword">DESC</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> per_sum<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    id<span class="token punctuation">,</span> category_id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> stock</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">FROM</span> goods<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h4 id="分布函数-cume_dist函数"><a class="anchor" href="#分布函数-cume_dist函数">#</a> 分布函数 - CUME_DIST () 函数</h4>
<ul>
<li>
<p>CUME_DIST () 函数主要用于查询小于或等于某个值的比例</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#查询 goods 数据表中小于或等于当前价格的比例</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">SELECT</span> CUME_DIST<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price<span class="token punctuation">)</span> <span class="token keyword">AS</span></pre></td></tr><tr><td data-num="3"></td><td><pre>cum<span class="token punctuation">,</span>id<span class="token punctuation">,</span> category_id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> stock</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">FROM</span> goods<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h4 id="前后函数-lagexprn函数"><a class="anchor" href="#前后函数-lagexprn函数">#</a> 前后函数 - LAG (expr,n) 函数</h4>
<ul>
<li>
<p>返回当前行的前 n 行的 expr 的值</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> pre</pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">FROM</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> LAG<span class="token punctuation">(</span>price<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price<span class="token punctuation">)</span> <span class="token keyword">AS</span> pre</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">from</span> goods <span class="token punctuation">)</span> pre_num<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h4 id="前后函数-leadexprn函数"><a class="anchor" href="#前后函数-leadexprn函数">#</a> 前后函数 - LEAD (expr,n) 函数</h4>
<ul>
<li>
<p>返回当前行的后 n 行的 expr 的值</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> later_price</pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">FROM</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">SELECT</span>  id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span>LEAD<span class="token punctuation">(</span>price<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price<span class="token punctuation">)</span> <span class="token keyword">AS</span> later_price</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">FROM</span> goods</pre></td></tr><tr><td data-num="5"></td><td><pre>     <span class="token punctuation">)</span> t<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h4 id="首尾函数-first_valueexpr函数"><a class="anchor" href="#首尾函数-first_valueexpr函数">#</a> 首尾函数 - FIRST_VALUE (expr) 函数</h4>
<ul>
<li>
<p>返回第一个 expr 的值</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> first_price</pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">FROM</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">SELECT</span>  id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span>FIRST_VALUE<span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price<span class="token punctuation">)</span> <span class="token keyword">AS</span> first_price</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">FROM</span> goods</pre></td></tr><tr><td data-num="5"></td><td><pre>     <span class="token punctuation">)</span> t<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h4 id="首尾函数-last_valueexpr函数"><a class="anchor" href="#首尾函数-last_valueexpr函数">#</a> 首尾函数 - LAST_VALUE (expr) 函数</h4>
<ul>
<li>
<p>返回最后一个 expr 的值</p>
</li>
<li>
<p>默认返回第一行到当前行，不加 range 时 值恒等于当前行的值</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> last_price</pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">FROM</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">SELECT</span>  id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span>LAST_VALUE<span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price RANGE <span class="token operator">BETWEEN</span> <span class="token keyword">UNBOUNDED</span> <span class="token keyword">PRECEDING</span> <span class="token operator">AND</span> <span class="token keyword">UNBOUNDED</span> <span class="token keyword">FOLLOWING</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> last_price</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">FROM</span> goods</pre></td></tr><tr><td data-num="5"></td><td><pre>     <span class="token punctuation">)</span> t<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h4 id="其它函数-nth_valueexprn函数"><a class="anchor" href="#其它函数-nth_valueexprn函数">#</a> 其它函数 - NTH_VALUE (expr,n) 函数</h4>
<ul>
<li>
<p>返回第 n 个 expr 的值</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span>nth_price</pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">FROM</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">SELECT</span>  id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span>NTH_VALUE<span class="token punctuation">(</span>price<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price<span class="token punctuation">)</span> <span class="token keyword">AS</span> nth_price</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">FROM</span> goods</pre></td></tr><tr><td data-num="5"></td><td><pre>     <span class="token punctuation">)</span> t<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<p>返回第三行的 price 数据，不满足 3 行，即 1 2 行置于 NULL</p>
</li>
</ul>
<h4 id="其它函数-ntilen函数"><a class="anchor" href="#其它函数-ntilen函数">#</a> 其它函数 - NTILE (n) 函数</h4>
<ul>
<li>
<p>将分区中的有序数据分为 n 个桶，记录桶编号</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">SELECT</span> ntile<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> category_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price<span class="token punctuation">)</span> <span class="token keyword">AS</span> nth<span class="token punctuation">,</span>id<span class="token punctuation">,</span> category<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">FROM</span> goods<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h3 id="公用表表达式"><a class="anchor" href="#公用表表达式">#</a> 公用表表达式</h3>
<ul>
<li>CTE 可以理解成一个可以复用的子查询</li>
</ul>
<h4 id="普通公用表表达式"><a class="anchor" href="#普通公用表表达式">#</a> 普通公用表表达式</h4>
<ul>
<li>
<p>可以被多次引用，而且可以被其他的普通公用表表达式所引用</p>
</li>
<li>
<p>WITH CTE 名称<br>
 AS （子查询）<br>
SELECT|DELETE|UPDATE 语句；</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">WITH</span> price_</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">AS</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">SELECT</span> price</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">FROM</span> goods</pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">WHERE</span> price <span class="token operator">&lt;=</span> <span class="token number">500</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> price_ p <span class="token keyword">JOIN</span> goods g</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">ON</span> p<span class="token punctuation">.</span>price <span class="token operator">=</span> g<span class="token punctuation">.</span>price<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<h4 id="递归公用表表达式"><a class="anchor" href="#递归公用表表达式">#</a> 递归公用表表达式</h4>
<ul>
<li>
<p>可以调用自己</p>
</li>
<li>
<p>WITH RECURSIVE<br>
CTE 名称 AS （子查询）<br>
SELECT|DELETE|UPDATE 语句；</p>
</li>
<li>
<p>种子查询和递归查询，中间通过关键字 UNION [ALL] 进行连接</p>
</li>
<li>
<figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">WITH</span> RECURSIVE cte </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">AS</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>manager_id<span class="token punctuation">,</span><span class="token number">1</span> <span class="token keyword">AS</span> n <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">100</span> </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">-- 种子查询，找到第一代领导</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">UNION</span> <span class="token keyword">ALL</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>a<span class="token punctuation">.</span>manager_id<span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">FROM</span> employees <span class="token keyword">AS</span> a <span class="token keyword">JOIN</span> cte</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">ON</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> cte<span class="token punctuation">.</span>employee_id<span class="token punctuation">)</span> <span class="token comment">-- 递归查询，找出以递归公用表表达式的人为领导的人</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name <span class="token keyword">FROM</span> cte <span class="token keyword">WHERE</span> n <span class="token operator">>=</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li>
</ul>
<div class="tags"><a href="../tags/sql-MySQL/" rel="tag"><i class="ic i-tag"></i>sql,MySQL</a></div></div><footer><div class="meta"><span class="icon"><i class="ic i-eye"></i></span><span>此文章已被阅读次数:</span><span class="waline-pageview-count" id="twikoo_visitors" data-path="/java-mysql-2024-11-26-MySQL/">正在加载...</span><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于</span><time title="修改时间：2024-11-27 19:48:57" itemprop="dateModified" datetime="2024-11-27T19:48:57+08:00">2024-11-27</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i>赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img loading="lazy" data-src="../assets/wechatpay.png" alt="Maple Plus 微信支付"><p>微信支付</p></div><div><img loading="lazy" data-src="../assets/alipay.png" alt="Maple Plus 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>Maple Plus<i class="ic i-at"><em>@</em></i>Maple</li><li class="link"><strong>本文链接：</strong><a href="https://mapleplus.github.io/java-mysql-2024-11-26-MySQL/" title="MySQL">https://mapleplus.github.io/java-mysql-2024-11-26-MySQL/</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="../java-javase-2024-11-25-JavaSE/" rel="prev" itemprop="url" data-background-image="https:&#x2F;&#x2F;image.fxink.cn&#x2F;maple&#x2F;IMG_20241127_090726.jpg" title="JavaSE"><span class="type">上一篇</span><span class="category"><i class="ic i-flag"></i>JavaSE</span><h3>JavaSE</h3></a></div><div class="item right"><a href="../maozedong-second-057-%E5%85%B3%E4%BA%8E%E6%89%93%E9%80%80%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%85%B1%E9%AB%98%E6%BD%AE%E7%9A%84%E6%80%BB%E7%BB%93/" rel="next" itemprop="url" data-background-image="https:&#x2F;&#x2F;image.fxink.cn&#x2F;maple&#x2F;%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E7%BE%8E%E5%A5%B3-%E9%BB%91%E4%B8%9D.png" title="关于打退第二次反共高潮的总结"><span class="type">下一篇</span><span class="category"><i class="ic i-flag"></i>第二卷</span><h3>关于打退第二次反共高潮的总结</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E5%82%A8%E5%A4%87"><span class="toc-number">1.</span> <span class="toc-text"> 基础储备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dml-%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.</span> <span class="toc-text"> DML 查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.1.</span> <span class="toc-text"> 多表查询的基本介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5-%E9%9D%9E%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.2.</span> <span class="toc-text"> 自连接 非自连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5-%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.3.</span> <span class="toc-text"> 内连接 外连接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text"> 函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.</span> <span class="toc-text"> 单行函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E8%AE%A4%E8%AF%86"><span class="toc-number">3.1.1.</span> <span class="toc-text"> 基础认识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E5%9E%8B%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.2.</span> <span class="toc-text"> 数值型函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.2.1.</span> <span class="toc-text"> 基本函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.3.</span> <span class="toc-text"> 字符串函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.4.</span> <span class="toc-text"> 日期和时间函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.5.</span> <span class="toc-text"> 流程控制函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.</span> <span class="toc-text"> 聚合函数（分组函数）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%B8%B8%E8%A7%81%E7%9A%84%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 1. 常见的聚合函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#avg-sum%E6%95%B0%E5%80%BC"><span class="toc-number">3.2.1.1.</span> <span class="toc-text"> AVG &#x2F; SUM（数值）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#max-min%E6%95%B0%E5%80%BC%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E6%97%A5%E6%9C%9F-%E6%97%B6%E9%97%B4%E7%B1%BB"><span class="toc-number">3.2.1.2.</span> <span class="toc-text"> MAX &#x2F; MIN（数值 &#x2F; 字符串类 &#x2F; 日期、时间类）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#count"><span class="toc-number">3.2.1.3.</span> <span class="toc-text"> COUNT</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2group-by-f1f2"><span class="toc-number">3.2.2.</span> <span class="toc-text"> 2.GROUP BY f1,f2…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3having"><span class="toc-number">3.2.3.</span> <span class="toc-text"> 3.HAVING</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sql%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-number">3.2.4.</span> <span class="toc-text"> SQL 底层原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.</span> <span class="toc-text"> 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.3.1.</span> <span class="toc-text"> 基本介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.2.</span> <span class="toc-text"> 单行子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.3.</span> <span class="toc-text"> 多行子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#more"><span class="toc-number">3.3.4.</span> <span class="toc-text"> more</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ddl-%E5%88%9B%E5%BB%BA-%E4%BF%AE%E6%94%B9-%E5%88%A0%E9%99%A4-%E5%BA%93-%E8%A1%A8"><span class="toc-number">4.</span> <span class="toc-text"> DDL 创建 修改 删除 库、表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">4.1.</span> <span class="toc-text"> 创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">4.2.</span> <span class="toc-text"> 修改数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">4.3.</span> <span class="toc-text"> 删除数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-number">4.4.</span> <span class="toc-text"> 创建表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8"><span class="toc-number">4.5.</span> <span class="toc-text"> 修改表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E8%A1%A8"><span class="toc-number">4.6.</span> <span class="toc-text"> 重命名表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8"><span class="toc-number">4.7.</span> <span class="toc-text"> 删除表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E7%A9%BA%E8%A1%A8"><span class="toc-number">4.8.</span> <span class="toc-text"> 清空表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dcl"><span class="toc-number">5.</span> <span class="toc-text"> DCL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#commit"><span class="toc-number">5.1.</span> <span class="toc-text"> COMMIT；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rollback"><span class="toc-number">5.2.</span> <span class="toc-text"> ROLLBACK；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E6%BB%9A"><span class="toc-number">5.3.</span> <span class="toc-text"> 回滚</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dml-%E5%A2%9E%E5%88%A0%E6%94%B9-%E6%95%B0%E6%8D%AE"><span class="toc-number">6.</span> <span class="toc-text"> DML 增删改 数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-number">6.1.</span> <span class="toc-text"> 添加数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">6.2.</span> <span class="toc-text"> 删除数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="toc-number">6.3.</span> <span class="toc-text"> 更新数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql80-%E6%96%B0%E7%89%B9%E6%80%A7"><span class="toc-number">6.4.</span> <span class="toc-text"> sql8.0 新特性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">7.</span> <span class="toc-text"> 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E5%9E%8B"><span class="toc-number">7.1.</span> <span class="toc-text"> 整型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F"><span class="toc-number">8.</span> <span class="toc-text"> 约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">8.1.</span> <span class="toc-text"> 概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E5%88%86%E7%B1%BB"><span class="toc-number">8.2.</span> <span class="toc-text"> 约束分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-number">8.3.</span> <span class="toc-text"> 非空约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%94%AF%E4%B8%80%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-number">8.4.</span> <span class="toc-text"> 唯一性约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#primary-key-%E7%BA%A6%E6%9D%9F"><span class="toc-number">8.5.</span> <span class="toc-text"> PRIMARY KEY 约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%A2%9E%E5%88%97-auto_increment"><span class="toc-number">8.6.</span> <span class="toc-text"> 自增列 AUTO_INCREMENT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#foreign-key-%E7%BA%A6%E6%9D%9F%E4%BA%86%E8%A7%A3"><span class="toc-number">8.7.</span> <span class="toc-text"> *FOREIGN KEY 约束（了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#check-%E7%BA%A6%E6%9D%9F"><span class="toc-number">8.8.</span> <span class="toc-text"> CHECK 约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#default%E7%BA%A6%E6%9D%9F"><span class="toc-number">8.9.</span> <span class="toc-text"> DEFAULT 约束</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">9.</span> <span class="toc-text"> 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E6%A6%82%E8%BF%B0"><span class="toc-number">9.1.</span> <span class="toc-text"> 视图概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE"><span class="toc-number">9.2.</span> <span class="toc-text"> 创建视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%A7%86%E5%9B%BE"><span class="toc-number">9.3.</span> <span class="toc-text"> 查看视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE"><span class="toc-number">9.4.</span> <span class="toc-text"> 更新视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9-%E5%88%A0%E9%99%A4%E8%A7%86%E5%9B%BE"><span class="toc-number">9.5.</span> <span class="toc-text"> 修改 删除视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A7%86%E5%9B%BE"><span class="toc-number">9.5.1.</span> <span class="toc-text"> 修改视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A7%86%E5%9B%BE"><span class="toc-number">9.5.2.</span> <span class="toc-text"> 删除视图</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B-%E5%87%BD%E6%95%B0"><span class="toc-number">10.</span> <span class="toc-text"> 存储过程、函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">10.1.</span> <span class="toc-text"> 存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D-2"><span class="toc-number">10.1.1.</span> <span class="toc-text"> 基本介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">10.1.2.</span> <span class="toc-text"> 创建存储过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">10.2.</span> <span class="toc-text"> 存储函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%AF%94"><span class="toc-number">10.3.</span> <span class="toc-text"> 对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9"><span class="toc-number">10.4.</span> <span class="toc-text"> 修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-number">10.5.</span> <span class="toc-text"> 删除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6-%E6%B8%B8%E6%A0%87"><span class="toc-number">11.</span> <span class="toc-text"> 变量 流程控制 游标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">11.1.</span> <span class="toc-text"> 变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D-3"><span class="toc-number">11.1.1.</span> <span class="toc-text"> 基本介绍</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">11.2.</span> <span class="toc-text"> 系统变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">11.2.1.</span> <span class="toc-text"> 查看系统变量</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F"><span class="toc-number">11.3.</span> <span class="toc-text"> 用户变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%9A%E8%AF%9D%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F"><span class="toc-number">11.3.1.</span> <span class="toc-text"> 会话用户变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="toc-number">11.3.2.</span> <span class="toc-text"> 局部变量</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%9D%A1%E4%BB%B6%E4%B8%8E%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-number">12.</span> <span class="toc-text"> 定义条件与处理程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%9D%A1%E4%BB%B6"><span class="toc-number">12.1.</span> <span class="toc-text"> 定义条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-number">12.2.</span> <span class="toc-text"> 处理程序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-number">13.</span> <span class="toc-text"> 流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84%E4%B9%8B-if"><span class="toc-number">13.1.</span> <span class="toc-text"> 分支结构之 IF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84%E4%B9%8B-case"><span class="toc-number">13.2.</span> <span class="toc-text"> 分支结构之 CASE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84%E4%B9%8Bloop"><span class="toc-number">13.3.</span> <span class="toc-text"> 循环结构之 LOOP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84%E4%B9%8Bwhile"><span class="toc-number">13.4.</span> <span class="toc-text"> 循环结构之 WHILE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84%E4%B9%8Brepeat"><span class="toc-number">13.5.</span> <span class="toc-text"> 循环结构之 REPEAT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BD%AC%E8%AF%AD%E5%8F%A5%E4%B9%8Bleave%E8%AF%AD%E5%8F%A5"><span class="toc-number">13.6.</span> <span class="toc-text"> 跳转语句之 LEAVE 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BD%AC%E8%AF%AD%E5%8F%A5%E4%B9%8Biterate%E8%AF%AD%E5%8F%A5"><span class="toc-number">13.7.</span> <span class="toc-text"> 跳转语句之 ITERATE 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87%E5%85%89%E6%A0%87"><span class="toc-number">13.8.</span> <span class="toc-text"> 游标 (光标)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">14.</span> <span class="toc-text"> 触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">14.1.</span> <span class="toc-text"> 触发器的创建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BE%E4%BE%8B"><span class="toc-number">14.1.1.</span> <span class="toc-text"> 举例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">14.2.</span> <span class="toc-text"> 查看触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">14.3.</span> <span class="toc-text"> 删除触发器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql80%E6%96%B0%E7%89%B9%E6%80%A7"><span class="toc-number">15.</span> <span class="toc-text"> sql8.0 新特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.</span> <span class="toc-text"> 窗口函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D-4"><span class="toc-number">15.1.1.</span> <span class="toc-text"> 基本介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%8F%B7%E5%87%BD%E6%95%B0-row_number%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.2.</span> <span class="toc-text"> 序号函数 - ROW_NUMBER () 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%8F%B7%E5%87%BD%E6%95%B0-rank%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.3.</span> <span class="toc-text"> 序号函数 - RANK () 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%8F%B7%E5%87%BD%E6%95%B0-dense_rank%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.4.</span> <span class="toc-text"> 序号函数 - DENSE_RANK () 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0-percent_rank%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.5.</span> <span class="toc-text"> 分布函数 - PERCENT_RANK () 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0-cume_dist%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.6.</span> <span class="toc-text"> 分布函数 - CUME_DIST () 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E5%87%BD%E6%95%B0-lagexprn%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.7.</span> <span class="toc-text"> 前后函数 - LAG (expr,n) 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E5%87%BD%E6%95%B0-leadexprn%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.8.</span> <span class="toc-text"> 前后函数 - LEAD (expr,n) 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A6%96%E5%B0%BE%E5%87%BD%E6%95%B0-first_valueexpr%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.9.</span> <span class="toc-text"> 首尾函数 - FIRST_VALUE (expr) 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A6%96%E5%B0%BE%E5%87%BD%E6%95%B0-last_valueexpr%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.10.</span> <span class="toc-text"> 首尾函数 - LAST_VALUE (expr) 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E5%87%BD%E6%95%B0-nth_valueexprn%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.11.</span> <span class="toc-text"> 其它函数 - NTH_VALUE (expr,n) 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E5%87%BD%E6%95%B0-ntilen%E5%87%BD%E6%95%B0"><span class="toc-number">15.1.12.</span> <span class="toc-text"> 其它函数 - NTILE (n) 函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E7%94%A8%E8%A1%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">15.2.</span> <span class="toc-text"> 公用表表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E5%85%AC%E7%94%A8%E8%A1%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">15.2.1.</span> <span class="toc-text"> 普通公用表表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E5%85%AC%E7%94%A8%E8%A1%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">15.2.2.</span> <span class="toc-text"> 递归公用表表达式</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="" rel="bookmark" title="MySQL">MySQL</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="Maple Plus" src="../assets/avatar.png"><p class="name" itemprop="name">Maple Plus</p><div class="description" itemprop="description">为国民幸福而国家富强</div></div><nav class="state"><div class="item posts"><a href="../archives/"><span class="count">231</span><span class="name">文章</span></a></div><div class="item categories"><a href="../categories/"><span class="count">9</span><span class="name">分类</span></a></div><div class="item tags"><a href="../tags/"><span class="count">3</span><span class="name">标签</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/mapleplus" class="item github" title="https:&#x2F;&#x2F;github.com&#x2F;mapleplus"><i class="ic i-github"></i></a></div><div class="menu"><li class="item"><a href="../index.html" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="#" onclick="return false;"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="../archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="../categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="../tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="../maozedong-second-057-%E5%85%B3%E4%BA%8E%E6%89%93%E9%80%80%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%85%B1%E9%AB%98%E6%BD%AE%E7%9A%84%E6%80%BB%E7%BB%93/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="../java-javase-2024-11-25-JavaSE/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="../categories/maozedong/" title="分类于毛泽东选集">毛泽东选集</a><i class="ic i-angle-right"></i><a href="../categories/maozedong/second/" title="分类于第二卷">第二卷</a></div><span><a href="../maozedong-second-031-%E9%9D%92%E5%B9%B4%E8%BF%90%E5%8A%A8%E7%9A%84%E6%96%B9%E5%90%91/">青年运动的方向</a></span></li><li class="item"><div class="breadcrumb"><a href="../categories/maozedong/" title="分类于毛泽东选集">毛泽东选集</a><i class="ic i-angle-right"></i><a href="../categories/maozedong/third/" title="分类于第三卷">第三卷</a></div><span><a href="../maozedong-third-077-%E8%AF%84%E8%92%8B%E4%BB%8B%E7%9F%B3%E5%9C%A8%E5%8F%8C%E5%8D%81%E8%8A%82%E7%9A%84%E6%BC%94%E8%AF%B4/">评蒋介石在双十节的演说</a></span></li><li class="item"><div class="breadcrumb"><a href="../categories/maozedong/" title="分类于毛泽东选集">毛泽东选集</a><i class="ic i-angle-right"></i><a href="../categories/maozedong/third/" title="分类于第三卷">第三卷</a></div><span><a href="../maozedong-third-081-%E4%B8%A4%E4%B8%AA%E4%B8%AD%E5%9B%BD%E4%B9%8B%E5%91%BD%E8%BF%90/">两个中国之命运</a></span></li><li class="item"><div class="breadcrumb"><a href="../categories/maozedong/" title="分类于毛泽东选集">毛泽东选集</a><i class="ic i-angle-right"></i><a href="../categories/maozedong/fifth/" title="分类于第五卷">第五卷</a></div><span><a href="../maozedong-fifth-159-%E4%B8%AD%E5%9B%BD%E4%BA%BA%E6%B0%91%E7%AB%99%E8%B5%B7%E6%9D%A5%E4%BA%86/">中国人民站起来了</a></span></li><li class="item"><div class="breadcrumb"><a href="../categories/maozedong/" title="分类于毛泽东选集">毛泽东选集</a><i class="ic i-angle-right"></i><a href="../categories/maozedong/fourth/" title="分类于第四卷">第四卷</a></div><span><a href="../maozedong-fourth-139-%E4%B8%AD%E5%85%B1%E5%8F%91%E8%A8%80%E4%BA%BA%E8%AF%84%E5%8D%97%E4%BA%AC%E8%A1%8C%E6%94%BF%E9%99%A2%E7%9A%84%E5%86%B3%E8%AE%AE/">中共发言人评南京行政院的决议</a></span></li><li class="item"><div class="breadcrumb"><a href="../categories/maozedong/" title="分类于毛泽东选集">毛泽东选集</a><i class="ic i-angle-right"></i><a href="../categories/maozedong/fifth/" title="分类于第五卷">第五卷</a></div><span><a href="../maozedong-fifth-184-%E8%A7%A3%E5%86%B3%E2%80%9C%E4%BA%94%E5%A4%9A%E2%80%9D%E9%97%AE%E9%A2%98/">解决“五多”问题</a></span></li><li class="item"><div class="breadcrumb"><a href="../categories/maozedong/" title="分类于毛泽东选集">毛泽东选集</a><i class="ic i-angle-right"></i><a href="../categories/maozedong/third/" title="分类于第三卷">第三卷</a></div><span><a href="../maozedong-third-083-%E6%84%9A%E5%85%AC%E7%A7%BB%E5%B1%B1/">愚公移山</a></span></li><li class="item"><div class="breadcrumb"><a href="../categories/maozedong/" title="分类于毛泽东选集">毛泽东选集</a><i class="ic i-angle-right"></i><a href="../categories/maozedong/fifth/" title="分类于第五卷">第五卷</a></div><span><a href="../maozedong-fifth-167-%E4%BD%A0%E4%BB%AC%E6%98%AF%E5%85%A8%E6%B0%91%E6%97%8F%E7%9A%84%E6%A8%A1%E8%8C%83%E4%BA%BA%E7%89%A9/">你们是全民族的模范人物</a></span></li><li class="item"><div class="breadcrumb"><a href="../categories/maozedong/" title="分类于毛泽东选集">毛泽东选集</a><i class="ic i-angle-right"></i><a href="../categories/maozedong/fifth/" title="分类于第五卷">第五卷</a></div><span><a href="../maozedong-fifth-162-%E6%B0%B8%E8%BF%9C%E4%BF%9D%E6%8C%81%E8%89%B0%E8%8B%A6%E5%A5%8B%E6%96%97%E7%9A%84%E4%BD%9C%E9%A3%8E/">永远保持艰苦奋斗的作风</a></span></li><li class="item"><div class="breadcrumb"><a href="../categories/maozedong/" title="分类于毛泽东选集">毛泽东选集</a><i class="ic i-angle-right"></i><a href="../categories/maozedong/fourth/" title="分类于第四卷">第四卷</a></div><span><a href="../maozedong-fourth-157-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%AE%A8%E8%AE%BA%E7%99%BD%E7%9A%AE%E4%B9%A6%EF%BC%9F/">为什么要讨论白皮书？</a></span></li></ul></div><div class="rpost pjax"><h2>最新评论</h2><ul class="leancloud-recent-comment" id="new-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 -<span itemprop="copyrightYear">2024</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">Maple Plus @ Maple Plus</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">1.4m 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">21:33</span></div><div class="powered-by">基于 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL = {
    ispost: true,
        path: `java-mysql-2024-11-26-MySQL/`,
        favicon: {
        show: `one piece!😎`,
        hide: `枫的最后一句🍁`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};
</script><script src="https://s4.zstatic.net/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous" fetchpriority="high"></script><script src="https://s4.zstatic.net/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha384-ZvpUoO&#x2F;+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn&#x2F;6Z&#x2F;hRTt8+pR6L4N2" crossorigin="anonymous" fetchpriority="high"></script><script src="../js/siteInit.js?v=0.4.16" type="module" fetchpriority="high" defer="defer"></script></body></html>